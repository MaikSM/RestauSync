import{a as Z}from"./chunk-2JFMUPWE.js";import{a as B,b as u,c as j,d as U,g as $,h as z,i as H,j as J,k as K,l as Q,m as W,q as X,s as Y}from"./chunk-AG2IGI7A.js";import"./chunk-NMI43S2G.js";import{b as L,d as R}from"./chunk-UFL7QPX4.js";import"./chunk-7IYL6UTE.js";import{l as V,m as O,q as G}from"./chunk-JQOZS3TN.js";import{Aa as a,Bb as r,Db as w,Na as D,R as v,Sa as s,Wb as q,Z as S,Za as l,_ as M,_a as g,gb as n,hb as e,ib as p,mb as T,pb as P,qb as f}from"./chunk-CFQE6O6P.js";import{a as N,b as k}from"./chunk-4X36HX5K.js";function ee(t,o){if(t&1&&(n(0,"div",8),r(1),e()),t&2){let d=f();a(),w(" ",d.errorMessage," ")}}function te(t,o){t&1&&(n(0,"div",9)(1,"p",10),r(2,"Cargando movimiento de inventario..."),e()())}function ie(t,o){t&1&&(n(0,"div",9)(1,"p",10),r(2,"Guardando cambios..."),e()())}function ne(t,o){t&1&&(n(0,"div",32),r(1," ID de ingrediente es requerido. "),e())}function oe(t,o){t&1&&(n(0,"div",32),r(1," ID de usuario es requerido. "),e())}function re(t,o){t&1&&(n(0,"div",32),r(1," Cantidad es requerida y debe ser mayor o igual a 0. "),e())}function ae(t,o){if(t&1&&(n(0,"option",33),r(1),e()),t&2){let d=o.$implicit;l("value",d),a(),w(" ",d," ")}}function de(t,o){t&1&&(n(0,"div",32),r(1," Tipo de movimiento es requerido. "),e())}function le(t,o){t&1&&(n(0,"div",32),r(1," Fecha es requerida. "),e())}function me(t,o){t&1&&(n(0,"div",32),r(1," Costo total es requerido y debe ser mayor o igual a 0. "),e())}function se(t,o){if(t&1){let d=T();n(0,"form",11),P("ngSubmit",function(){S(d);let c=f();return M(c.onSave())}),n(1,"div")(2,"label",12),r(3,"ID Ingrediente"),e(),p(4,"input",13),s(5,ne,2,0,"div",14),e(),n(6,"div")(7,"label",15),r(8,"ID Usuario"),e(),p(9,"input",16),s(10,oe,2,0,"div",14),e(),n(11,"div")(12,"label",17),r(13,"Cantidad"),e(),p(14,"input",18),s(15,re,2,0,"div",14),e(),n(16,"div")(17,"label",19),r(18,"Tipo de Movimiento"),e(),n(19,"select",20)(20,"option",21),r(21,"Seleccione un tipo"),e(),s(22,ae,2,2,"option",22),e(),s(23,de,2,0,"div",14),e(),n(24,"div")(25,"label",23),r(26,"Fecha"),e(),p(27,"input",24),s(28,le,2,0,"div",14),e(),n(29,"div")(30,"label",25),r(31,"Motivo"),e(),p(32,"textarea",26),e(),n(33,"div")(34,"label",27),r(35,"Costo Total"),e(),p(36,"input",28),s(37,me,2,0,"div",14),e(),n(38,"div",29)(39,"button",30),r(40," \u{1F4BE} Guardar "),e(),n(41,"button",31),P("click",function(){S(d);let c=f();return M(c.onCancel())}),r(42," \u274C Cancelar "),e()()()}if(t&2){let d,m,c,_,b,x,h,y,F,C,E,I,i=f();l("formGroup",i.editForm),a(4),g("border-red-500",((d=i.editForm.get("ingrediente_id"))==null?null:d.invalid)&&((d=i.editForm.get("ingrediente_id"))==null?null:d.touched)),a(),l("ngIf",((m=i.editForm.get("ingrediente_id"))==null?null:m.invalid)&&((m=i.editForm.get("ingrediente_id"))==null?null:m.touched)),a(4),g("border-red-500",((c=i.editForm.get("usuario_id"))==null?null:c.invalid)&&((c=i.editForm.get("usuario_id"))==null?null:c.touched)),a(),l("ngIf",((_=i.editForm.get("usuario_id"))==null?null:_.invalid)&&((_=i.editForm.get("usuario_id"))==null?null:_.touched)),a(4),g("border-red-500",((b=i.editForm.get("cantidad"))==null?null:b.invalid)&&((b=i.editForm.get("cantidad"))==null?null:b.touched)),a(),l("ngIf",((x=i.editForm.get("cantidad"))==null?null:x.invalid)&&((x=i.editForm.get("cantidad"))==null?null:x.touched)),a(4),g("border-red-500",((h=i.editForm.get("tipo_movimiento"))==null?null:h.invalid)&&((h=i.editForm.get("tipo_movimiento"))==null?null:h.touched)),a(3),l("ngForOf",i.tipoMovimientoOptions),a(),l("ngIf",((y=i.editForm.get("tipo_movimiento"))==null?null:y.invalid)&&((y=i.editForm.get("tipo_movimiento"))==null?null:y.touched)),a(4),g("border-red-500",((F=i.editForm.get("fecha"))==null?null:F.invalid)&&((F=i.editForm.get("fecha"))==null?null:F.touched)),a(),l("ngIf",((C=i.editForm.get("fecha"))==null?null:C.invalid)&&((C=i.editForm.get("fecha"))==null?null:C.touched)),a(8),g("border-red-500",((E=i.editForm.get("costo_total"))==null?null:E.invalid)&&((E=i.editForm.get("costo_total"))==null?null:E.touched)),a(),l("ngIf",((I=i.editForm.get("costo_total"))==null?null:I.invalid)&&((I=i.editForm.get("costo_total"))==null?null:I.touched)),a(2),l("disabled",i.editForm.invalid)}}var A=class t{_router=v(R);_route=v(L);_fb=v(X);_inventarioService=v(Z);_cdr=v(q);movimiento_id=this._route.snapshot.params.movimiento_id;editForm;isLoading=!1;isSaving=!1;errorMessage="";tipoMovimientoOptions=["Entrada","Salida","Ajuste"];ngOnInit(){this.editForm=this._fb.group({ingrediente_id:[null,u.required],usuario_id:[null,u.required],cantidad:[null,[u.required,u.min(0)]],tipo_movimiento:["",u.required],fecha:["",u.required],motivo:[""],costo_total:[null,[u.required,u.min(0)]]}),this.loadMovimiento()}loadMovimiento(){if(!this.movimiento_id||isNaN(+this.movimiento_id)){this.errorMessage="ID de movimiento inv\xE1lido. Verifique la URL.",this.isLoading=!1,this._cdr.markForCheck();return}this.isLoading=!0,this.errorMessage="",this._inventarioService.getById(+this.movimiento_id).subscribe({next:o=>{let d=k(N({},o),{fecha:(()=>{if(!o.fecha)return"";try{return new Date(o.fecha).toISOString().split("T")[0]}catch{return""}})()});this.editForm.patchValue(d),this.isLoading=!1,this._cdr.markForCheck()},error:o=>{this.isLoading=!1,this._cdr.markForCheck(),o.status===404?this.errorMessage="Movimiento de inventario no encontrado. Verifique que el ID sea correcto.":o.status===500?this.errorMessage="Error interno del servidor. Intente nuevamente m\xE1s tarde.":o.status===0||!o.status?this.errorMessage="No se pudo conectar al servidor. Verifique su conexi\xF3n a internet.":this.errorMessage=`Error al cargar el movimiento de inventario: ${o.message||"Error desconocido"}`}})}onSave(){this.editForm.valid?(this.isSaving=!0,this.errorMessage="",this._inventarioService.updateById(+this.movimiento_id,this.editForm.value).subscribe({next:()=>{this.isSaving=!1,this._cdr.markForCheck(),this._router.navigate(["/admin/inventario"])},error:()=>{this.errorMessage="Error al guardar el movimiento de inventario",this.isSaving=!1,this._cdr.markForCheck()}})):(console.log("Form is invalid, errors:",this.editForm.errors),this.errorMessage="Por favor, complete todos los campos requeridos correctamente",this.isSaving=!1)}onCancel(){this._router.navigate(["/admin/inventario"])}static \u0275fac=function(d){return new(d||t)};static \u0275cmp=D({type:t,selectors:[["admin-inventario-edit-page"]],decls:11,vars:4,consts:[[1,"bg-gray-900","text-gray-100","min-h-screen","p-6"],[1,"max-w-4xl","mx-auto"],[1,"bg-gray-800","rounded-xl","shadow-lg","p-6"],[1,"border-b","border-gray-700","pb-4","mb-6"],[1,"text-2xl","font-bold","text-orange-500","mb-0"],["class","bg-red-600 text-white p-4 rounded-lg mb-4",4,"ngIf"],["class","text-center mt-3",4,"ngIf"],["class","space-y-6",3,"formGroup","ngSubmit",4,"ngIf"],[1,"bg-red-600","text-white","p-4","rounded-lg","mb-4"],[1,"text-center","mt-3"],[1,"text-gray-300"],[1,"space-y-6",3,"ngSubmit","formGroup"],["for","ingrediente_id",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","number","id","ingrediente_id","formControlName","ingrediente_id",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["class","text-red-400 text-sm mt-1",4,"ngIf"],["for","usuario_id",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","number","id","usuario_id","formControlName","usuario_id",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","cantidad",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","number","id","cantidad","formControlName","cantidad",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","tipo_movimiento",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["id","tipo_movimiento","formControlName","tipo_movimiento",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","fecha",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","date","id","fecha","formControlName","fecha",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","motivo",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["id","motivo","formControlName","motivo","rows","3",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","costo_total",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","number","step","0.01","id","costo_total","formControlName","costo_total",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],[1,"flex","justify-end","space-x-4","mt-6"],["type","submit",1,"bg-orange-500","hover:bg-orange-600","text-white","px-6","py-2","rounded-md","shadow","transition","disabled:opacity-50",3,"disabled"],["type","button",1,"bg-gray-600","hover:bg-gray-700","text-white","px-6","py-2","rounded-md","shadow","transition",3,"click"],[1,"text-red-400","text-sm","mt-1"],[3,"value"]],template:function(d,m){d&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),r(5,"\u270F\uFE0F Editar Movimiento de Inventario"),e()(),n(6,"div"),s(7,ee,2,1,"div",5)(8,te,3,0,"div",6)(9,ie,3,0,"div",6)(10,se,43,21,"form",7),e()()()()),d&2&&(a(7),l("ngIf",m.errorMessage),a(),l("ngIf",m.isLoading),a(),l("ngIf",m.isSaving),a(),l("ngIf",!m.isLoading&&!m.isSaving))},dependencies:[G,V,O,Y,$,Q,W,B,z,K,j,U,H,J],encapsulation:2,changeDetection:0})},Ee=A;export{A as AdminInventarioEditPageComponent,Ee as default};
