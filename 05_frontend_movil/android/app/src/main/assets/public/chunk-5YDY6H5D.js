import{a as C,b as u,c as R,d as E,g as _,i as A,j as L,q as N,s as P}from"./chunk-AG2IGI7A.js";import{a}from"./chunk-4XBRS2GN.js";import{a as F}from"./chunk-GONPXOC7.js";import"./chunk-ASKH5DUS.js";import{a as S}from"./chunk-NMI43S2G.js";import{b,d as y,e as w}from"./chunk-UFL7QPX4.js";import"./chunk-7IYL6UTE.js";import"./chunk-JQOZS3TN.js";import{Aa as f,Bb as r,Na as h,R as l,Za as v,gb as t,hb as o,ib as c,ma as m,pb as x}from"./chunk-CFQE6O6P.js";import"./chunk-4X36HX5K.js";var g=class p{_router=l(y);_authService=l(F);_formBuilder=l(N);_activatedRoute=l(b);hasError=m(!1);isPosting=m(!1);loginForm=this._formBuilder.group({email:["",[u.required,u.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]],password:["",[u.required,u.minLength(8)]]});onSubmit(){try{if(console.log("\u{1F680} Iniciando proceso de login..."),console.log("\u{1F4F1} User Agent:",typeof window<"u"&&window.navigator?window.navigator.userAgent:"Unknown"),console.log("\u{1F310} URL actual:",window.location.href),this.loginForm.invalid){console.log("\u274C Formulario inv\xE1lido:",this.loginForm.errors),a.error("Inicio de Sesi\xF3n Fallido",{duration:2e3,description:"Por Favor, Completa Todos los Campos Requeridos"});return}let i={email:this.loginForm.controls.email.value,password:this.loginForm.controls.password.value};console.log("\u{1F4E4} Datos a enviar:",{email:i.email,password:"***"}),console.log("\u{1F517} API URL:",`${S.apiUrl}/auth/login`),this.isPosting.set(!0),this._authService.login(i).subscribe({next:e=>{if(console.log("\u2705 Respuesta del servicio de auth:",e),e){a.success("Inicio de Sesi\xF3n Exitoso",{duration:2e3,description:"Bienvenido de Nuevo"});let n=this._activatedRoute.snapshot.queryParams.returnUrl;if(n){console.log("\u{1F500} Redirigiendo al returnUrl:",n),this._router.navigateByUrl(n);return}let d=this._authService.user()?.role_id,s="/";d===4?s="/waiter":d===1?s="/admin":s="/private/reservas",console.log("\u{1F500} Redirigiendo a:",s),this._router.navigateByUrl(s);return}console.log("\u274C Login fallido - credenciales incorrectas"),a.error("Inicio de Sesi\xF3n Fallido",{duration:2e3,description:"Credenciales Incorrectas"}),this.isPosting.set(!1)},error:e=>{console.error("\u{1F4A5} Error en login:",e),console.error("\u{1F50D} Detalles del error:",{status:e.status,statusText:e.statusText,message:e.message,url:e.url}),a.error("Error de Conexi\xF3n",{duration:4e3,description:`Error ${e.status||"desconocido"}: ${e.message||"No se pudo conectar con el servidor"}`}),this.isPosting.set(!1)}})}catch(i){console.error("\u{1F4A5} Error inesperado:",i),a.error("Error Inesperado",{duration:3e3,description:"Ha ocurrido un error inesperado. Revisa la consola."})}}static \u0275fac=function(e){return new(e||p)};static \u0275cmp=h({type:p,selectors:[["auth-login-page"]],decls:20,vars:1,consts:[[1,"min-h-[70vh]","flex","items-center","justify-center","bg-gray-900","py-2","px-4"],[1,"w-full","max-w-sm","bg-gray-800","rounded-xl","shadow-2xl","p-8","border","border-gray-700"],[1,"text-3xl","font-bold","text-center","text-orange-500","mb-8"],[1,"space-y-6",3,"ngSubmit","formGroup"],["for","email",1,"block","text-sm","font-medium","text-gray-300","mb-2"],["type","email","placeholder","tu@email.com","formControlName","email",1,"w-full","px-4","py-3","bg-gray-900","border","border-gray-600","rounded-lg","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500","focus:border-transparent","transition-all","duration-300"],["for","password",1,"block","text-sm","font-medium","text-gray-300","mb-2"],["type","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","formControlName","password",1,"w-full","px-4","py-3","bg-gray-900","border","border-gray-600","rounded-lg","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500","focus:border-transparent","transition-all","duration-300"],["type","submit",1,"w-full","bg-orange-500","hover:bg-orange-600","text-white","font-semibold","py-3","px-4","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","duration-300","transform","hover:scale-105","mt-8"],[1,"text-center","mt-6"],[1,"text-sm","text-gray-400"],["routerLink","/auth/register",1,"text-sm","font-medium","text-orange-500","hover:text-orange-400","transition-colors","duration-300"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"h2",2),r(3," Iniciar Sesi\xF3n "),o(),t(4,"form",3),x("ngSubmit",function(){return n.onSubmit()}),t(5,"div")(6,"label",4),r(7," Correo Electr\xF3nico "),o(),c(8,"input",5),o(),t(9,"div")(10,"label",6),r(11," Contrase\xF1a "),o(),c(12,"input",7),o(),t(13,"button",8),r(14," Ingresar "),o()(),t(15,"div",9)(16,"span",10),r(17,"\xBFNo tienes cuenta? "),o(),t(18,"a",11),r(19,"Reg\xEDstrate"),o()()()()),e&2&&(f(4),v("formGroup",n.loginForm))},dependencies:[P,_,C,R,E,A,L,w],encapsulation:2,changeDetection:0})},Z=g;export{g as AuthLoginPageComponent,Z as default};
