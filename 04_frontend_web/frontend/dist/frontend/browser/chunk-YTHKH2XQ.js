import{a as L}from"./chunk-LDKFQ7O5.js";import{a as V}from"./chunk-E7FNAGCF.js";import{a as F,b as i,c as N,d as A,g as B,i as D,j as U,k as I,l as k,m as M,q,s as G}from"./chunk-AG2IGI7A.js";import{a}from"./chunk-4XBRS2GN.js";import{a as v}from"./chunk-ASKH5DUS.js";import{b as E,d as R}from"./chunk-UFL7QPX4.js";import{q as w}from"./chunk-JQOZS3TN.js";import{Aa as d,Bb as n,Db as g,Na as y,R as l,Za as p,bc as b,cb as x,cc as S,eb as _,fb as C,gb as t,hb as r,i as h,ib as s,ma as c,pb as f}from"./chunk-CFQE6O6P.js";function T(m,e){if(m&1&&(t(0,"option",21),n(1),r()),m&2){let o=e.$implicit;p("value",o.id),d(),g(" ",o.name," ")}}var j=class m{constructor(){S(()=>{let e=this.userData.value(),o=this.rolesResource.value();!this.isCreateMode()&&e&&o&&this.form.patchValue({name:e.name,surname:e.surname,email:e.email,password:e.password,role_id:e.role?.id})})}isSelected=c(!1);_usersService=l(V);_rolesService=l(L);_route=l(E);_router=l(R);_formBuilder=l(q);currentUrl=c(this._router.url);isCreateMode=b(()=>this.currentUrl().endsWith("/create"));userId=b(()=>this.isCreateMode()?null:Number(this._route.snapshot.paramMap.get("id")));userData=v({loader:()=>this.userId()===null?h(Promise.resolve(null)):this._usersService.getById(this.userId())});rolesResource=v({loader:()=>this._rolesService.getAll()});form=this._formBuilder.group({name:this._formBuilder.control("",[i.required,i.minLength(4)]),surname:this._formBuilder.control("",[i.required,i.minLength(4)]),email:this._formBuilder.control("",[i.required,i.email]),password:this._formBuilder.control("",[i.required,i.minLength(8)]),confirmation:this._formBuilder.control("",[i.required,i.minLength(8)]),role_id:this._formBuilder.control(null,[i.required,i.min(1)])});onCleanForm(){this.form.reset()}onSubmit(){try{if(this.form.invalid){a.error("Error al Crear el Registro",{description:"Por Favor Verifique los Campos",duration:3e3});return}if(this.form.value.password!==this.form.value.confirmation){a.error("Error al Crear el Registro",{description:"Las contrase\xF1as no coinciden",duration:3e3});return}let e={id:this.isCreateMode()?0:this.userId(),name:this.form.value.name,surname:this.form.value.surname,email:this.form.value.email,role_id:Number(this.form.value.role_id),password:this.form.value.password};this.isCreateMode()?this._usersService.create(e).subscribe({next:()=>{a.success("Registro Creado",{description:`El registro: ${e.name}, se cre\xF3 correctamente `,duration:3e3}),this._router.navigate(["/admin/users"])},error:o=>{console.error(o),a.error("Error al Crear el Registro",{description:"Error al crear el registro, por favor intente nuevamente.",duration:3e3})}}):this._usersService.updateById(this.userId(),e).subscribe({next:()=>{a.success("Registro Actualizado",{description:`El registro: ${e.name}, se actualiz\xF3 correctamente `,duration:3e3}),this._router.navigate(["/admin/users"])},error:o=>{console.error(o),a.error("Error al Actualizar el Registro",{description:"Error al actualizar el registro, por favor intente nuevamente.",duration:3e3})}})}catch(e){console.error(e),a.error("Error al Procesar el Registro",{description:"Error al crear el registro, por favor intente nuevamente.",duration:3e3})}}static \u0275fac=function(o){return new(o||m)};static \u0275cmp=y({type:m,selectors:[["admin-users-form"]],decls:42,vars:2,consts:[[1,"bg-gray-900","text-gray-100","min-h-screen","p-6"],[1,"flex","items-center","justify-center"],[1,"bg-gray-800","rounded-xl","shadow-lg","border","border-gray-700","w-full","max-w-2xl"],[1,"p-6"],[1,"text-2xl","font-bold","text-center","text-orange-500","mb-6"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"flex","justify-between","w-full","gap-2"],[1,"block","w-full"],["for","name",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","text","placeholder","Juan","formControlName","name",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","surname",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","text","placeholder","Benjumea Correa","formControlName","surname",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","email",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","email","formControlName","email","placeholder","correo@electronico.com",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","password",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","password","formControlName","password",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","confirmation",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","password","formControlName","confirmation",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],[1,"w-full"],["for","role_id",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["formControlName","role_id",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","focus:outline-none","focus:ring-2","focus:ring-orange-500"],[3,"value"],[1,"flex","justify-around","gap-1","mt-6"],["type","submit",1,"w-full","bg-orange-500","hover:bg-orange-600","text-white","font-bold","py-2","px-4","rounded-md","transition","duration-200"],["type","button",1,"w-full","bg-gray-600","hover:bg-gray-500","text-gray-100","font-bold","py-2","px-4","rounded-md","transition","duration-200",3,"click"]],template:function(o,u){o&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),n(5," \u{1F465} Datos del Usuario "),r(),t(6,"form",5),f("ngSubmit",function(){return u.onSubmit()}),t(7,"div",6)(8,"div",7)(9,"label",8),n(10," Nombre(s) "),r(),s(11,"input",9),r(),t(12,"div",7)(13,"label",10),n(14," Apellido(s) "),r(),s(15,"input",11),r()(),t(16,"div")(17,"label",12),n(18," Email "),r(),s(19,"input",13),r(),t(20,"div",6)(21,"div",7)(22,"label",14),n(23," Contrase\xF1a "),r(),s(24,"input",15),r(),t(25,"div",7)(26,"label",16),n(27," Confirmaci\xF3n "),r(),s(28,"input",17),r()(),t(29,"div",18)(30,"label",19),n(31," Seleccione un Rol "),r(),t(32,"select",20),_(33,T,2,2,"option",21,x),r()(),t(35,"div",22)(36,"div",18)(37,"button",23),n(38),r()(),t(39,"div",18)(40,"button",24),f("click",function(){return u.onCleanForm()}),n(41," Limpiar "),r()()()()()()()()),o&2&&(d(6),p("formGroup",u.form),d(27),C(u.rolesResource.value()),d(5),g(" ",u.userId()===null?"Crear":"Actualizar"," "))},dependencies:[w,G,B,k,M,F,I,N,A,D,U],encapsulation:2,changeDetection:0})};export{j as a};
