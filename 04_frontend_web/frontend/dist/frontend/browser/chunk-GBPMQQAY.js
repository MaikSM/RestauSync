import{a as q}from"./chunk-QCLI6S55.js";import{a as D}from"./chunk-DUFSMT6L.js";import"./chunk-NMI43S2G.js";import{e as F}from"./chunk-UFL7QPX4.js";import"./chunk-7IYL6UTE.js";import{l as V,m as T,o as M,p as W,q as $}from"./chunk-JQOZS3TN.js";import{$ as P,Aa as d,Bb as i,Cb as _,Db as c,Na as C,Nb as u,Pb as k,R as w,Rb as v,Sa as f,Z as m,Za as b,_ as p,aa as S,ab as h,gb as n,hb as t,ib as I,mb as y,pb as x,qb as s}from"./chunk-CFQE6O6P.js";import{a as O}from"./chunk-4X36HX5K.js";function j(l,r){l&1&&(n(0,"tr",19)(1,"td",20),i(2,"No hay pedidos registrados"),t()())}function B(l,r){if(l&1){let e=y();n(0,"tr",19)(1,"td",13),i(2),t(),n(3,"td",13),i(4),t(),n(5,"td",13),i(6),t(),n(7,"td",13),i(8),u(9,"currency"),t(),n(10,"td",13)(11,"span"),i(12),t()(),n(13,"td",21)(14,"button",22),x("click",function(){let o=m(e).$implicit,g=s();return p(g.viewOrder(o))}),i(15," Ver "),t(),n(16,"button",23),x("click",function(){let o=m(e).$implicit,g=s();return p(g.editOrder(o))}),i(17," Editar "),t(),n(18,"button",24),x("click",function(){let o=m(e).$implicit,g=s();return p(g.deleteOrder(o.id))}),i(19," Eliminar "),t()()()}if(l&2){let e=r.$implicit;d(2),_(e.id),d(2),_(e.mesa),d(2),_(e.cliente||"-"),d(2),_(v(9,7,e.total,"COP","symbol","1.0-0")),d(3),h(e.estado==="Listo"?"text-green-400":"text-orange-400"),d(),c(" ",e.estado," ")}}function N(l,r){if(l&1&&(n(0,"div",41)(1,"div")(2,"p",42),i(3),t(),n(4,"p",43),i(5),t()(),n(6,"p",44),i(7),u(8,"currency"),t()()),l&2){let e=r.$implicit;d(3),_(e.nombre),d(2),c("Cantidad: ",e.qty,""),d(2),_(v(8,3,e.precio*e.qty,"COP","symbol","1.0-0"))}}function z(l,r){if(l&1){let e=y();n(0,"div",28)(1,"div",29)(2,"h3",30),i(3),t(),n(4,"button",31),x("click",function(){m(e);let o=s(2);return p(o.closeModal())}),i(5,"\xD7"),t()(),n(6,"div",32)(7,"div")(8,"p",33)(9,"strong"),i(10,"Mesa:"),t(),i(11),t(),n(12,"p",33)(13,"strong"),i(14,"Cliente:"),t(),i(15),t(),n(16,"p",33)(17,"strong"),i(18,"Estado:"),t(),n(19,"span"),i(20),t()(),n(21,"p",33)(22,"strong"),i(23,"Fecha:"),t(),i(24),u(25,"date"),t()(),n(26,"div")(27,"p",33)(28,"strong"),i(29,"Subtotal:"),t(),i(30),u(31,"currency"),t(),n(32,"p",33)(33,"strong"),i(34,"Impuesto (10%):"),t(),i(35),u(36,"currency"),t(),n(37,"p",34)(38,"strong"),i(39,"Total:"),t(),i(40),u(41,"currency"),t()()(),n(42,"h4",35),i(43,"Art\xEDculos del Pedido"),t(),n(44,"div",36),f(45,N,9,8,"div",37),t(),n(46,"div",38)(47,"button",39),x("click",function(){m(e);let o=s(2);return p(o.printReceipt(o.selectedOrder))}),i(48," Generar Comprobante "),t(),n(49,"button",40),x("click",function(){m(e);let o=s(2);return p(o.closeModal())}),i(50," Cerrar "),t()()()}if(l&2){let e=s(2);d(3),c("Detalles del Pedido ",e.selectedOrder.id,""),d(8),c(" ",e.selectedOrder.mesa,""),d(4),c(" ",e.selectedOrder.cliente||"N/A",""),d(4),h(e.selectedOrder.estado==="Listo"?"text-green-400":"text-orange-400"),d(),c(" ",e.selectedOrder.estado," "),d(4),c(" ",k(25,11,e.selectedOrder.fecha,"short"),""),d(6),c(" ",v(31,14,e.selectedOrder.subtotal,"COP","symbol","1.0-0"),""),d(5),c(" ",v(36,19,e.selectedOrder.tax,"COP","symbol","1.0-0"),""),d(5),c(" ",v(41,24,e.selectedOrder.total,"COP","symbol","1.0-0"),""),d(5),b("ngForOf",e.selectedOrder.items)}}function A(l,r){if(l&1){let e=y();n(0,"div",25),x("click",function(){m(e);let o=s();return p(o.closeModal())}),n(1,"div",26),x("click",function(o){return m(e),p(o.stopPropagation())}),f(2,z,51,29,"div",27),t()()}if(l&2){let e=s();d(2),b("ngIf",e.selectedOrder)}}function L(l,r){if(l&1){let e=y();n(0,"div",41)(1,"div",50)(2,"p",42),i(3),t(),n(4,"p",43),i(5),u(6,"currency"),t()(),n(7,"div",51)(8,"div",52)(9,"button",53),x("click",function(){let o=m(e).index,g=s(3);return p(g.decreaseItemQty(o))}),i(10,"-"),t(),n(11,"span",54),i(12),t(),n(13,"button",55),x("click",function(){let o=m(e).index,g=s(3);return p(g.increaseItemQty(o))}),i(14,"+"),t()(),n(15,"p",56),i(16),u(17,"currency"),t(),n(18,"button",57),x("click",function(){let o=m(e).index,g=s(3);return p(g.removeItem(o))}),i(19," Eliminar "),t()()()}if(l&2){let e=r.$implicit;d(3),_(e.nombre),d(2),c("Precio unitario: ",v(6,4,e.precio,"COP","symbol","1.0-0"),""),d(7),_(e.qty),d(4),_(v(17,9,e.precio*e.qty,"COP","symbol","1.0-0"))}}function G(l,r){if(l&1){let e=y();n(0,"div",41)(1,"div",50)(2,"p",42),i(3),t(),n(4,"p",43),i(5),t(),n(6,"p",44),i(7),u(8,"currency"),t()(),n(9,"button",58),x("click",function(){let o=m(e).$implicit,g=s(3);return p(g.addDishToOrder(o))}),i(10," Agregar "),t()()}if(l&2){let e=r.$implicit;d(3),_(e.nombre),d(2),_(e.descripcion),d(2),_(v(8,3,e.precio,"COP","symbol","1.0-0"))}}function J(l,r){if(l&1){let e=y();n(0,"div",28)(1,"div",29)(2,"h3",46),i(3),t(),n(4,"button",31),x("click",function(){m(e);let o=s(2);return p(o.closeEditModal())}),i(5,"\xD7"),t()(),n(6,"div",32)(7,"div")(8,"p",33)(9,"strong"),i(10,"Mesa:"),t(),i(11),t(),n(12,"p",33)(13,"strong"),i(14,"Cliente:"),t(),i(15),t(),n(16,"p",33)(17,"strong"),i(18,"Estado:"),t(),n(19,"span"),i(20),t()()(),n(21,"div")(22,"p",33)(23,"strong"),i(24,"Subtotal:"),t(),i(25),u(26,"currency"),t(),n(27,"p",33)(28,"strong"),i(29,"Impuesto (10%):"),t(),i(30),u(31,"currency"),t(),n(32,"p",47)(33,"strong"),i(34,"Total:"),t(),i(35),u(36,"currency"),t()()(),n(37,"h4",35),i(38,"Art\xEDculos del Pedido"),t(),n(39,"div",48),f(40,L,20,14,"div",37),t(),n(41,"h4",35),i(42,"Agregar Platos"),t(),n(43,"div",49),f(44,G,11,8,"div",37),t(),n(45,"div",38)(46,"button",40),x("click",function(){m(e);let o=s(2);return p(o.closeEditModal())}),i(47," Cancelar "),t(),n(48,"button",39),x("click",function(){m(e);let o=s(2);return p(o.saveOrderChanges())}),i(49," Guardar Cambios "),t()()()}if(l&2){let e=s(2);d(3),c("Editar Pedido ",e.editingOrder.id,""),d(8),c(" ",e.editingOrder.mesa,""),d(4),c(" ",e.editingOrder.cliente||"N/A",""),d(4),h(e.editingOrder.estado==="Listo"?"text-green-400":"text-orange-400"),d(),c(" ",e.editingOrder.estado," "),d(5),c(" ",v(26,11,e.editingOrder.subtotal,"COP","symbol","1.0-0"),""),d(5),c(" ",v(31,16,e.editingOrder.tax,"COP","symbol","1.0-0"),""),d(5),c(" ",v(36,21,e.editingOrder.total,"COP","symbol","1.0-0"),""),d(5),b("ngForOf",e.editingOrder.items),d(4),b("ngForOf",e.menu)}}function Q(l,r){if(l&1){let e=y();n(0,"div",25),x("click",function(){m(e);let o=s();return p(o.closeEditModal())}),n(1,"div",45),x("click",function(o){return m(e),p(o.stopPropagation())}),f(2,J,50,26,"div",27),t()()}if(l&2){let e=s();d(2),b("ngIf",e.editingOrder)}}var E=class l{platosService=w(D);orders=[];menu=[];showModal=!1;showEditModal=!1;selectedOrder=null;editingOrder=null;ngOnInit(){console.log("\u{1F4CB} Componente de Pedidos del Mesero cargado correctamente"),this.loadOrders(),this.loadMenu()}loadOrders(){let r=JSON.parse(localStorage.getItem("pedidos")||"[]");this.orders=r.reverse()}loadMenu(){this.platosService.getAll().subscribe({next:r=>{this.menu=r.filter(e=>e.disponible)},error:r=>{console.error("Error loading menu:",r),this.menu=[{plato_id:1,nombre:"Hamburguesa",descripcion:"Deliciosa hamburguesa con queso",precio:25e3,disponible:!0,imagen_url:"",categoria:"Principales",created_at:new Date().toISOString()},{plato_id:2,nombre:"Pizza Margherita",descripcion:"Pizza cl\xE1sica con tomate y mozzarella",precio:3e4,disponible:!0,imagen_url:"",categoria:"Principales",created_at:new Date().toISOString()},{plato_id:3,nombre:"Ensalada C\xE9sar",descripcion:"Ensalada fresca con aderezo c\xE9sar",precio:18e3,disponible:!0,imagen_url:"",categoria:"Ensaladas",created_at:new Date().toISOString()}]}})}viewOrder(r){this.selectedOrder=r,this.showModal=!0}editOrder(r){this.editingOrder=O({},r),this.showEditModal=!0}closeModal(){this.showModal=!1,this.selectedOrder=null}closeEditModal(){this.showEditModal=!1,this.editingOrder=null}decreaseItemQty(r){this.editingOrder&&this.editingOrder.items[r].qty>1&&(this.editingOrder.items[r].qty--,this.updateOrderTotals())}increaseItemQty(r){this.editingOrder&&(this.editingOrder.items[r].qty++,this.updateOrderTotals())}removeItem(r){this.editingOrder&&this.editingOrder.items.length>1?(this.editingOrder.items.splice(r,1),this.updateOrderTotals()):alert("El pedido debe tener al menos un art\xEDculo.")}updateOrderTotals(){this.editingOrder&&(this.editingOrder.subtotal=this.editingOrder.items.reduce((r,e)=>r+e.precio*e.qty,0),this.editingOrder.tax=this.editingOrder.subtotal*.1,this.editingOrder.total=this.editingOrder.subtotal+this.editingOrder.tax)}addDishToOrder(r){if(this.editingOrder){let e=this.editingOrder.items.find(a=>a.id===r.plato_id);e?e.qty++:this.editingOrder.items.push({id:r.plato_id,nombre:r.nombre,precio:r.precio,qty:1}),this.updateOrderTotals()}}saveOrderChanges(){if(this.editingOrder){let r=JSON.parse(localStorage.getItem("pedidos")||"[]"),e=r.findIndex(a=>a.id===this.editingOrder.id);e!==-1&&(r[e]=O({},this.editingOrder),localStorage.setItem("pedidos",JSON.stringify(r)),this.loadOrders(),this.closeEditModal(),alert("Pedido actualizado exitosamente."))}}deleteOrder(r){if(confirm("\xBFEst\xE1s seguro de que quieres eliminar este pedido?")){let a=JSON.parse(localStorage.getItem("pedidos")||"[]").filter(o=>o.id!==r);localStorage.setItem("pedidos",JSON.stringify(a)),this.loadOrders()}}printReceipt(r){let e=new q;e.setFontSize(20),e.text("Comprobante de Pago",20,20),e.setFontSize(12),e.text(`Pedido: ${r.id}`,20,40),e.text(`Mesa: ${r.mesa}`,20,50),e.text(`Cliente: ${r.cliente||"N/A"}`,20,60),e.text(`Fecha: ${new Date(r.fecha).toLocaleString()}`,20,70);let a=90;e.text("Items:",20,a),a+=10,r.items.forEach(o=>{e.text(`${o.nombre} x${o.qty} - $${(o.precio*o.qty).toFixed(2)}`,20,a),a+=10}),a+=10,e.text(`Subtotal: $${r.subtotal.toFixed(2)}`,20,a),a+=10,e.text(`Impuesto (10%): $${r.tax.toFixed(2)}`,20,a),a+=10,e.text(`Total: $${r.total.toFixed(2)}`,20,a),e.save(`comprobante-${r.id}.pdf`)}gestionarPedidos(){console.log("\u{1F37D}\uFE0F Gestionando pedidos desde Angular..."),this.loadOrders()}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=C({type:l,selectors:[["waiter-pedidos-page"]],decls:40,vars:4,consts:[[1,"bg-gray-900","text-gray-100","flex","flex-col","min-h-screen"],[1,"bg-gray-800","shadow-md"],[1,"max-w-7xl","mx-auto","px-6","py-4","flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-orange-500"],[1,"flex-1","max-w-7xl","mx-auto","px-3","sm:px-6","py-6","sm:py-8"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-xl","font-semibold","text-gray-200"],["routerLink","/waiter/nuevo-pedido",1,"inline-flex","items-center","gap-2","bg-orange-600","hover:bg-orange-700","px-3","py-2","sm:px-4","sm:py-2","rounded","shadow","transition","transform","hover:scale-105"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"h-5","w-5","text-gray-900"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"bg-gray-800","rounded-xl","shadow-md","overflow-x-auto"],[1,"w-full","text-left","text-gray-300","text-sm","sm:text-base"],[1,"bg-gray-700","text-gray-200"],[1,"py-2","px-2","sm:px-3"],["class","hover:bg-gray-700 transition",4,"ngIf"],["class","hover:bg-gray-700 transition",4,"ngFor","ngForOf"],[1,"bg-gray-800","py-4","mt-6"],[1,"max-w-7xl","mx-auto","px-6","flex","justify-between","items-center","text-sm","text-gray-400"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",3,"click",4,"ngIf"],[1,"hover:bg-gray-700","transition"],["colspan","6",1,"py-4","px-3","text-center","text-gray-400"],[1,"py-2","px-2","sm:px-3","flex","gap-2"],[1,"bg-orange-500","hover:bg-orange-600","px-2","py-1","rounded","text-sm",3,"click"],[1,"bg-blue-500","hover:bg-blue-600","px-2","py-1","rounded","text-sm",3,"click"],[1,"bg-red-500","hover:bg-red-600","px-2","py-1","rounded","text-sm",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-gray-800","rounded-xl","shadow-2xl","max-w-2xl","w-full","mx-4","max-h-[90vh]","overflow-y-auto",3,"click"],["class","p-6",4,"ngIf"],[1,"p-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-bold","text-orange-400"],[1,"text-gray-400","hover:text-white","text-2xl",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"text-gray-300"],[1,"text-orange-400","font-bold","text-lg"],[1,"text-lg","font-semibold","text-gray-200","mb-3"],[1,"bg-gray-700","rounded-lg","p-4"],["class","flex justify-between items-center py-2 border-b border-gray-600 last:border-b-0",4,"ngFor","ngForOf"],[1,"flex","justify-between","mt-6"],[1,"bg-blue-600","hover:bg-blue-700","px-4","py-2","rounded","text-sm",3,"click"],[1,"bg-gray-600","hover:bg-gray-700","px-4","py-2","rounded","text-sm",3,"click"],[1,"flex","justify-between","items-center","py-2","border-b","border-gray-600","last:border-b-0"],[1,"text-gray-100","font-medium"],[1,"text-gray-400","text-sm"],[1,"text-orange-400","font-semibold"],[1,"bg-gray-800","rounded-xl","shadow-2xl","max-w-4xl","w-full","mx-4","max-h-[90vh]","overflow-y-auto",3,"click"],[1,"text-xl","font-bold","text-blue-400"],[1,"text-blue-400","font-bold","text-lg"],[1,"bg-gray-700","rounded-lg","p-4","mb-4"],[1,"bg-gray-700","rounded-lg","p-4","mb-4","max-h-60","overflow-y-auto"],[1,"flex-1"],[1,"flex","items-center","gap-3"],[1,"flex","items-center","gap-2"],[1,"bg-red-600","hover:bg-red-700","w-8","h-8","rounded","flex","items-center","justify-center","text-sm",3,"click"],[1,"text-white","min-w-[2rem]","text-center"],[1,"bg-green-600","hover:bg-green-700","w-8","h-8","rounded","flex","items-center","justify-center","text-sm",3,"click"],[1,"text-blue-400","font-semibold","min-w-[4rem]","text-right"],[1,"bg-red-600","hover:bg-red-700","px-2","py-1","rounded","text-xs",3,"click"],[1,"bg-green-600","hover:bg-green-700","px-3","py-1","rounded","text-sm",3,"click"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),i(4,"\u{1F4CB} Pedidos"),t()()(),n(5,"main",4)(6,"div",5)(7,"h2",6),i(8,"Gesti\xF3n de Pedidos"),t(),n(9,"a",7),P(),n(10,"svg",8),I(11,"path",9),t(),i(12," Nuevo Pedido "),t()(),S(),n(13,"div",10)(14,"table",11)(15,"thead",12)(16,"tr")(17,"th",13),i(18,"# Pedido"),t(),n(19,"th",13),i(20,"Mesa"),t(),n(21,"th",13),i(22,"Cliente"),t(),n(23,"th",13),i(24,"Total"),t(),n(25,"th",13),i(26,"Estado"),t(),n(27,"th",13),i(28,"Acciones"),t()()(),n(29,"tbody"),f(30,j,3,0,"tr",14)(31,B,20,12,"tr",15),t()()()(),n(32,"footer",16)(33,"div",17)(34,"span"),i(35,"\xA9 2025 RestauSync. Todos los derechos reservados."),t(),n(36,"span"),i(37,"Desarrollado con \u2764\uFE0F y TailwindCSS"),t()()(),f(38,A,3,1,"div",18)(39,Q,3,1,"div",18),t()),e&2&&(d(30),b("ngIf",!a.orders.length),d(),b("ngForOf",a.orders),d(7),b("ngIf",a.showModal),d(),b("ngIf",a.showEditModal))},dependencies:[$,V,T,W,M,F],encapsulation:2})},re=E;export{E as WaiterPedidosPageComponent,re as default};
