import{a as Q}from"./chunk-OVZYRGGJ.js";import{a as A,c as V,f as z,k as G,l as q,m as J,r as K}from"./chunk-AG2IGI7A.js";import"./chunk-NMI43S2G.js";import{e as R}from"./chunk-UFL7QPX4.js";import"./chunk-7IYL6UTE.js";import{l as B,m as L,o as N,p as j,q as H}from"./chunk-JQOZS3TN.js";import{$ as D,Aa as n,Bb as i,Cb as s,Db as g,Gb as y,Hb as S,Ib as w,Na as P,Nb as p,Pb as O,R as E,Rb as x,Sa as u,Wb as k,Z as M,Za as c,_ as I,_a as T,aa as C,ab as f,gb as e,hb as t,ib as _,mb as W,pb as b,qb as v}from"./chunk-CFQE6O6P.js";import"./chunk-4X36HX5K.js";function U(d,a){d&1&&(e(0,"div",65),i(1," Pedido activo "),t())}function X(d,a){if(d&1&&(e(0,"div",60)(1,"div",61)(2,"div",62),i(3),t(),e(4,"div",63),i(5),t(),u(6,U,2,0,"div",64),t()()),d&2){let r=a.$implicit,o=v();f(o.getMesaStatusClass(r)),n(3),g("Mesa ",r.numero,""),n(),f(o.getMesaStatusTextClass(r)),n(),s(o.getMesaStatusText(r)),n(),c("ngIf",o.getOrderForTable(r.numero))}}function Y(d,a){if(d&1&&(e(0,"tr",66)(1,"td",67),i(2),t(),e(3,"td",30),i(4),t(),e(5,"td",30),i(6),t(),e(7,"td",68),i(8),p(9,"currency"),t(),e(10,"td",30)(11,"span"),i(12),t()(),e(13,"td",69),i(14),p(15,"date"),t()()),d&2){let r=a.$implicit,o=v();n(2),s(r.id),n(2),s(r.mesa),n(2),s(r.cliente||"-"),n(2),s(x(9,8,r.total,"COP","symbol","1.0-0")),n(3),f(o.getOrderStatusClass(r.estado)),n(),g(" ",r.estado," "),n(2),g(" ",O(15,13,r.fecha,"shortTime")," ")}}function Z(d,a){d&1&&(e(0,"tr")(1,"td",70),i(2," No hay pedidos recientes "),t()())}function $(d,a){if(d&1&&(e(0,"option",71),i(1),t()),d&2){let r=a.$implicit;c("value",r.numero),n(),g("Mesa ",r.numero,"")}}function ee(d,a){if(d&1&&(e(0,"div",101)(1,"div",75)(2,"div",102),i(3),t(),e(4,"div",103),i(5),t()(),e(6,"div",104),i(7),p(8,"currency"),t()()),d&2){let r=a.$implicit;n(3),s(r.nombre),n(2),g("Cantidad: ",r.qty,""),n(2),g(" ",x(8,3,r.precio*r.qty,"COP","symbol","1.0-0")," ")}}function te(d,a){if(d&1&&(e(0,"div",86)(1,"div",87)(2,"div")(3,"h4",88),i(4,"\u{1F37D}\uFE0F Platillos Ordenados"),t(),e(5,"div",89),u(6,ee,9,8,"div",90),t()(),e(7,"div")(8,"h4",88),i(9,"\u{1F4CB} Resumen"),t(),e(10,"div",91)(11,"div",92)(12,"span",93),i(13,"Subtotal:"),t(),e(14,"span",94),i(15),p(16,"currency"),t()(),e(17,"div",92)(18,"span",93),i(19,"Impuesto (10%):"),t(),e(20,"span",94),i(21),p(22,"currency"),t()(),e(23,"div",95)(24,"span",96),i(25,"Total:"),t(),e(26,"span",97),i(27),p(28,"currency"),t()()(),e(29,"div",98)(30,"h5",99),i(31,"\u{1F4DD} Notas"),t(),e(32,"p",100),i(33),t()()()()()),d&2){let r=v().$implicit;n(6),c("ngForOf",r.items),n(9),s(x(16,5,r.subtotal,"COP","symbol","1.0-0")),n(6),s(x(22,10,r.tax,"COP","symbol","1.0-0")),n(6),s(x(28,15,r.total,"COP","symbol","1.0-0")),n(6),s(r.notas||"Sin notas adicionales")}}function ie(d,a){if(d&1){let r=W();e(0,"div",72)(1,"div",73)(2,"div",74)(3,"div",75)(4,"div",76)(5,"h3",18),i(6),t(),e(7,"span",77),i(8),t()(),e(9,"div",78)(10,"div")(11,"span",79),i(12,"Mesa:"),t(),e(13,"span",80),i(14),t()(),e(15,"div")(16,"span",79),i(17,"Cliente:"),t(),e(18,"span",80),i(19),t()(),e(20,"div")(21,"span",79),i(22,"Fecha:"),t(),e(23,"span",80),i(24),p(25,"date"),t()(),e(26,"div")(27,"span",79),i(28,"Total:"),t(),e(29,"span",81),i(30),p(31,"currency"),t()()()(),e(32,"button",82),b("click",function(){let m=M(r).$implicit,l=v();return I(l.toggleOrderDetails(m))}),D(),e(33,"svg",83),_(34,"path",84),t()()()(),u(35,te,34,20,"div",85),t()}if(d&2){let r=a.$implicit,o=v();n(6),g("Pedido ",r.id,""),n(),f(o.getOrderStatusClass(r.estado)),n(),g(" ",r.estado," "),n(6),s(r.mesa),n(5),s(r.cliente||"N/A"),n(5),s(O(25,11,r.fecha,"short")),n(6),s(x(31,14,r.total,"COP","symbol","1.0-0")),n(3),T("rotate-180",r.showDetails),n(2),c("ngIf",r.showDetails)}}function re(d,a){d&1&&(e(0,"div",105)(1,"div",79),D(),e(2,"svg",106),_(3,"path",107),t(),C(),e(4,"p"),i(5,"No se encontraron pedidos con los filtros aplicados"),t()()())}var F=class d{mesasService=E(Q);cdr=E(k);metrics={activeOrders:0,occupiedTables:0,completedOrders:0,dailyRevenue:0};mesas=[];recentOrders=[];orderHistory=[];filteredOrderHistory=[];dateFilter="";tableFilter="";customerFilter="";statusFilter="";refreshInterval;ngOnInit(){console.log("\u{1F468}\u200D\u{1F373} Dashboard del Mesero cargado correctamente"),this.loadData(),this.refreshInterval=window.setInterval(()=>{this.loadData()},3e4)}ngOnDestroy(){this.refreshInterval&&clearInterval(this.refreshInterval)}loadData(){this.loadMesas(),this.loadOrders(),this.calculateMetrics()}loadMesas(){console.log("Loading mesas for dashboard..."),this.mesasService.getAll().subscribe({next:a=>{this.mesas=a,this.calculateMetrics(),this.cdr.detectChanges()},error:a=>{console.error("Error loading mesas:",a),this.mesas=[{mesa_id:1,numero:1,capacidad:4,estado:"libre",created_at:new Date().toISOString()},{mesa_id:2,numero:2,capacidad:4,estado:"ocupada",created_at:new Date().toISOString()},{mesa_id:3,numero:3,capacidad:6,estado:"libre",created_at:new Date().toISOString()},{mesa_id:4,numero:4,capacidad:2,estado:"reservada",created_at:new Date().toISOString()}],this.calculateMetrics(),this.cdr.detectChanges()}})}loadOrders(){let a=JSON.parse(localStorage.getItem("pedidos")||"[]");this.recentOrders=a.slice(-10).reverse(),this.orderHistory=a.reverse(),this.applyFilters(),this.calculateMetrics(),this.cdr.detectChanges()}calculateMetrics(){let a=JSON.parse(localStorage.getItem("pedidos")||"[]");this.metrics.activeOrders=a.filter(l=>l.estado!=="Completado"&&l.estado!=="Cancelado").length;let r=this.mesas.filter(l=>this.recentOrders.some(h=>parseInt(h.mesa)===l.numero&&h.estado!=="Completado"&&h.estado!=="Cancelado")).length,o=this.mesas.filter(l=>l.estado==="ocupada"||l.estado==="reservada").length;this.metrics.occupiedTables=Math.max(r,o);let m=new Date().toDateString();this.metrics.completedOrders=a.filter(l=>new Date(l.fecha).toDateString()===m&&l.estado==="Completado").length,this.metrics.dailyRevenue=a.filter(l=>new Date(l.fecha).toDateString()===m).reduce((l,h)=>l+h.total,0)}refreshData(){this.loadData()}getOrderForTable(a){return this.recentOrders.find(r=>parseInt(r.mesa)===a)}getMesaStatusClass(a){let r="bg-gray-800 p-4 rounded-lg shadow hover:shadow-md transition-all duration-200";switch(a.estado){case"ocupada":return r+" border-l-4 border-red-500 bg-red-900/20";case"reservada":return r+" border-l-4 border-yellow-500 bg-yellow-900/20";case"mantenimiento":return r+" border-l-4 border-gray-500 bg-gray-900/20";default:return r+" border-l-4 border-green-500 bg-green-900/20"}}getMesaStatusText(a){switch(a.estado){case"libre":return"Libre";case"ocupada":return"Ocupada";case"reservada":return"Reservada";case"mantenimiento":return"Mantenimiento";default:return a.estado}}getMesaStatusTextClass(a){switch(a.estado){case"libre":return"text-green-400";case"ocupada":return"text-red-400";case"reservada":return"text-yellow-400";case"mantenimiento":return"text-gray-400";default:return"text-gray-400"}}getOrderStatusClass(a){switch(a){case"Recibido":return"text-blue-400";case"En preparaci\xF3n":return"text-yellow-400";case"Listo":return"text-green-400";case"Completado":return"text-green-600";case"Cancelado":return"text-red-400";default:return"text-gray-400"}}applyFilters(){let a=[...this.orderHistory];if(this.dateFilter){let r=new Date(this.dateFilter).toDateString();a=a.filter(o=>new Date(o.fecha).toDateString()===r)}if(this.tableFilter&&(a=a.filter(r=>r.mesa===this.tableFilter)),this.customerFilter.trim()){let r=this.customerFilter.toLowerCase();a=a.filter(o=>o.cliente&&o.cliente.toLowerCase().includes(r))}this.statusFilter&&(a=a.filter(r=>r.estado===this.statusFilter)),this.filteredOrderHistory=a}clearFilters(){this.dateFilter="",this.tableFilter="",this.customerFilter="",this.statusFilter="",this.applyFilters()}toggleOrderDetails(a){a.showDetails=!a.showDetails}static \u0275fac=function(r){return new(r||d)};static \u0275cmp=P({type:d,selectors:[["waiter-dashboard-page"]],decls:134,vars:19,consts:[[1,"bg-gray-900","text-gray-100","flex","flex-col","min-h-screen"],[1,"bg-gray-800","shadow-md"],[1,"max-w-7xl","mx-auto","px-6","py-4","flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-orange-500"],[1,"flex-1","max-w-7xl","mx-auto","px-6","py-8"],[1,"grid","md:grid-cols-4","gap-6","mb-8"],[1,"bg-gradient-to-br","from-gray-800","to-gray-700","p-6","rounded-xl","shadow-lg","hover:shadow-xl","transition-all","duration-300","border-l-4","border-blue-500"],[1,"flex","items-center","justify-between"],[1,"text-lg","font-bold","text-blue-400"],[1,"text-3xl","font-bold","mt-2","text-white"],[1,"text-blue-400","text-4xl"],[1,"bg-gradient-to-br","from-gray-800","to-gray-700","p-6","rounded-xl","shadow-lg","hover:shadow-xl","transition-all","duration-300","border-l-4","border-red-500"],[1,"text-lg","font-bold","text-red-400"],[1,"text-red-400","text-4xl"],[1,"bg-gradient-to-br","from-gray-800","to-gray-700","p-6","rounded-xl","shadow-lg","hover:shadow-xl","transition-all","duration-300","border-l-4","border-green-500"],[1,"text-lg","font-bold","text-green-400"],[1,"text-green-400","text-4xl"],[1,"bg-gradient-to-br","from-gray-800","to-gray-700","p-6","rounded-xl","shadow-lg","hover:shadow-xl","transition-all","duration-300","border-l-4","border-orange-500"],[1,"text-lg","font-bold","text-orange-400"],[1,"text-orange-400","text-4xl"],[1,"mb-8"],[1,"text-xl","font-semibold","text-gray-200","mb-4"],[1,"grid","grid-cols-2","md:grid-cols-4","lg:grid-cols-6","gap-4"],["class","bg-gray-800 p-4 rounded-lg shadow hover:shadow-md transition-all duration-200",3,"class",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-semibold","text-gray-200"],[1,"bg-gray-700","hover:bg-gray-600","px-3","py-1","rounded","text-sm",3,"click"],[1,"bg-gray-800","rounded-xl","shadow-md","overflow-hidden"],[1,"w-full","text-left","text-gray-300"],[1,"bg-gray-700","text-gray-200"],[1,"py-3","px-4"],["class","hover:bg-gray-700 transition",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mt-6","flex","gap-4"],["routerLink","/waiter/pedidos",1,"bg-orange-500","hover:bg-orange-600","px-4","py-2","rounded","shadow","transition"],["routerLink","/waiter/nuevo-pedido",1,"inline-flex","items-center","gap-2","bg-orange-600","hover:bg-orange-700","px-4","py-2","rounded","shadow","transition","transform","hover:scale-105"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"mt-8"],[1,"bg-gray-800","p-4","rounded-xl","shadow-md","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"block","text-sm","text-gray-300","mb-2"],["type","date",1,"w-full","bg-gray-700","border","border-gray-600","rounded","px-3","py-2","text-sm","focus:border-orange-500","focus:outline-none",3,"ngModelChange","ngModel"],[1,"w-full","bg-gray-700","border","border-gray-600","rounded","px-3","py-2","text-sm","focus:border-orange-500","focus:outline-none",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Buscar cliente...",1,"w-full","bg-gray-700","border","border-gray-600","rounded","px-3","py-2","text-sm","focus:border-orange-500","focus:outline-none",3,"ngModelChange","ngModel"],["value","Recibido"],["value","Preparando"],["value","Listo"],["value","Entregado"],["value","Cancelado"],[1,"flex","gap-2","mt-4"],[1,"bg-gray-600","hover:bg-gray-500","px-3","py-1","rounded","text-sm",3,"click"],[1,"bg-orange-600","hover:bg-orange-700","px-3","py-1","rounded","text-sm",3,"click"],[1,"space-y-4"],["class","bg-gray-800 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 overflow-hidden",4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],[1,"bg-gray-800","py-4","mt-6"],[1,"max-w-7xl","mx-auto","px-6","flex","justify-between","items-center","text-sm","text-gray-400"],[1,"bg-gray-800","p-4","rounded-lg","shadow","hover:shadow-md","transition-all","duration-200"],[1,"text-center"],[1,"text-lg","font-bold","text-white"],[1,"text-sm"],["class","text-xs text-orange-400 mt-1",4,"ngIf"],[1,"text-xs","text-orange-400","mt-1"],[1,"hover:bg-gray-700","transition"],[1,"py-3","px-4","font-medium"],[1,"py-3","px-4","font-semibold"],[1,"py-3","px-4","text-sm","text-gray-400"],["colspan","6",1,"py-8","px-4","text-center","text-gray-400"],[3,"value"],[1,"bg-gray-800","rounded-xl","shadow-md","hover:shadow-lg","transition-all","duration-200","overflow-hidden"],[1,"p-4","border-b","border-gray-700"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"flex","items-center","gap-4","mb-2"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4","text-sm"],[1,"text-gray-400"],[1,"text-white","ml-2"],[1,"text-orange-400","font-semibold","ml-2"],[1,"text-gray-400","hover:text-white","p-2","rounded-lg","hover:bg-gray-700","transition",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","transition-transform","duration-200"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","p-4 bg-gray-750",4,"ngIf"],[1,"p-4","bg-gray-750"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"text-md","font-semibold","text-gray-200","mb-3"],[1,"space-y-2"],["class","flex justify-between items-center p-3 bg-gray-700 rounded-lg",4,"ngFor","ngForOf"],[1,"bg-gray-700","p-4","rounded-lg","space-y-2"],[1,"flex","justify-between"],[1,"text-gray-300"],[1,"text-white"],[1,"border-t","border-gray-600","pt-2","flex","justify-between"],[1,"text-gray-200","font-semibold"],[1,"text-orange-400","font-bold"],[1,"mt-4"],[1,"text-sm","font-semibold","text-gray-200","mb-2"],[1,"text-gray-400","text-sm"],[1,"flex","justify-between","items-center","p-3","bg-gray-700","rounded-lg"],[1,"font-medium","text-white"],[1,"text-sm","text-gray-400"],[1,"text-orange-400","font-semibold"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","mb-4","opacity-50"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"]],template:function(r,o){r&1&&(e(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),i(4,"\u{1F468}\u200D\u{1F373} Dashboard Mesero"),t()()(),e(5,"main",4)(6,"section",5)(7,"div",6)(8,"div",7)(9,"div")(10,"h2",8),i(11,"Pedidos Activos"),t(),e(12,"p",9),i(13),t()(),e(14,"div",10),i(15,"\u{1F4CB}"),t()()(),e(16,"div",11)(17,"div",7)(18,"div")(19,"h2",12),i(20,"Mesas Ocupadas"),t(),e(21,"p",9),i(22),t()(),e(23,"div",13),i(24,"\u{1F37D}\uFE0F"),t()()(),e(25,"div",14)(26,"div",7)(27,"div")(28,"h2",15),i(29,"Pedidos Completados"),t(),e(30,"p",9),i(31),t()(),e(32,"div",16),i(33,"\u2705"),t()()(),e(34,"div",17)(35,"div",7)(36,"div")(37,"h2",18),i(38,"Ingresos del D\xEDa"),t(),e(39,"p",9),i(40),p(41,"currency"),t()(),e(42,"div",19),i(43,"\u{1F4B0}"),t()()()(),e(44,"section",20)(45,"h2",21),i(46,"Estado de Mesas"),t(),e(47,"div",22),u(48,X,7,7,"div",23),t()(),e(49,"section")(50,"div",24)(51,"h2",25),i(52,"\xDAltimos Pedidos"),t(),e(53,"button",26),b("click",function(){return o.refreshData()}),i(54," Actualizar "),t()(),e(55,"div",27)(56,"table",28)(57,"thead",29)(58,"tr")(59,"th",30),i(60,"# Pedido"),t(),e(61,"th",30),i(62,"Mesa"),t(),e(63,"th",30),i(64,"Cliente"),t(),e(65,"th",30),i(66,"Total"),t(),e(67,"th",30),i(68,"Estado"),t(),e(69,"th",30),i(70,"Hora"),t()()(),e(71,"tbody"),u(72,Y,16,16,"tr",31)(73,Z,3,0,"tr",32),t()()(),e(74,"div",33)(75,"a",34),i(76," Ver todos los pedidos "),t(),e(77,"a",35),D(),e(78,"svg",36),_(79,"path",37),t(),i(80," Nuevo Pedido "),t()()(),C(),e(81,"section",38)(82,"div",24)(83,"h2",25),i(84,"\u{1F4CA} Historial de Pedidos"),t(),e(85,"button",26),b("click",function(){return o.refreshData()}),i(86," Actualizar "),t()(),e(87,"div",39)(88,"div",40)(89,"div")(90,"label",41),i(91,"Filtrar por Fecha"),t(),e(92,"input",42),w("ngModelChange",function(l){return S(o.dateFilter,l)||(o.dateFilter=l),l}),t()(),e(93,"div")(94,"label",41),i(95,"Mesa"),t(),e(96,"select",43),w("ngModelChange",function(l){return S(o.tableFilter,l)||(o.tableFilter=l),l}),e(97,"option",44),i(98,"Todas las mesas"),t(),u(99,$,2,2,"option",45),t()(),e(100,"div")(101,"label",41),i(102,"Cliente"),t(),e(103,"input",46),w("ngModelChange",function(l){return S(o.customerFilter,l)||(o.customerFilter=l),l}),t()(),e(104,"div")(105,"label",41),i(106,"Estado"),t(),e(107,"select",43),w("ngModelChange",function(l){return S(o.statusFilter,l)||(o.statusFilter=l),l}),e(108,"option",44),i(109,"Todos los estados"),t(),e(110,"option",47),i(111,"Recibido"),t(),e(112,"option",48),i(113,"Preparando"),t(),e(114,"option",49),i(115,"Listo"),t(),e(116,"option",50),i(117,"Entregado"),t(),e(118,"option",51),i(119,"Cancelado"),t()()()(),e(120,"div",52)(121,"button",53),b("click",function(){return o.clearFilters()}),i(122," Limpiar Filtros "),t(),e(123,"button",54),b("click",function(){return o.applyFilters()}),i(124," Aplicar Filtros "),t()()(),e(125,"div",55),u(126,ie,36,19,"div",56)(127,re,6,0,"div",57),t()()(),e(128,"footer",58)(129,"div",59)(130,"span"),i(131,"\xA9 2025 RestauSync. Todos los derechos reservados."),t(),e(132,"span"),i(133,"Desarrollado con \u2764\uFE0F y TailwindCSS"),t()()()()),r&2&&(n(13),s(o.metrics.activeOrders),n(9),s(o.metrics.occupiedTables),n(9),s(o.metrics.completedOrders),n(9),s(x(41,14,o.metrics.dailyRevenue,"COP","symbol","1.0-0")),n(8),c("ngForOf",o.mesas.slice(0,12)),n(24),c("ngForOf",o.recentOrders),n(),c("ngIf",!o.recentOrders.length),n(19),y("ngModel",o.dateFilter),n(4),y("ngModel",o.tableFilter),n(3),c("ngForOf",o.mesas),n(4),y("ngModel",o.customerFilter),n(4),y("ngModel",o.statusFilter),n(19),c("ngForOf",o.filteredOrderHistory),n(),c("ngIf",!o.filteredOrderHistory.length))},dependencies:[H,B,L,j,N,R,K,q,J,A,G,V,z],encapsulation:2})},be=F;export{F as WaiterDashboardPageComponent,be as default};
