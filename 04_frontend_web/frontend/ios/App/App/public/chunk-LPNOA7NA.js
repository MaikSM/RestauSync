import{a as ie}from"./chunk-FEWWBC6R.js";import"./chunk-T532BZKW.js";import{a as ee}from"./chunk-ZA56YX54.js";import{d as te}from"./chunk-SZTE2ZOQ.js";import{a as J}from"./chunk-KHIHIFVV.js";import{a as X,b as Y,c as Z}from"./chunk-CCYSTRO3.js";import{a as z,c as q,f as O,r as K}from"./chunk-L57FSASQ.js";import{a as _}from"./chunk-7IX7VPDF.js";import{a as L}from"./chunk-DLFABNFZ.js";import"./chunk-YKSGIHVP.js";import"./chunk-IJHKA2LB.js";import{m as W}from"./chunk-IBNRR53B.js";import{$a as H,Ab as I,Bb as M,Ja as j,Nb as B,Oa as w,R,Ya as E,Z as f,_ as S,ab as V,bb as a,cb as i,db as P,g as G,hb as T,kb as u,lb as p,ma as h,ub as n,vb as v,wb as D,xa as d,xb as N,zb as F}from"./chunk-GQXGSY3T.js";import{a as Q,b as $,e as b}from"./chunk-YEWEO3AL.js";var k=te("BarcodeScanner",{web:()=>import("./chunk-YK6HG6V4.js").then(s=>new s.BarcodeScannerWeb)});var ae=(s,e)=>e.id;function ne(s,e){s&1&&P(0,"is-loading")}function re(s,e){if(s&1&&(a(0,"span",39),n(1),i()),s&2){let t=p().$implicit;d(),v(t.asistencia.hora_entrada)}}function oe(s,e){s&1&&(a(0,"span",40),n(1,"-"),i())}function se(s,e){if(s&1&&(a(0,"span",41),n(1),i()),s&2){let t=p().$implicit;d(),v(t.asistencia.hora_salida)}}function le(s,e){s&1&&(a(0,"span",40),n(1,"-"),i())}function de(s,e){if(s&1){let t=T();a(0,"tr",35)(1,"td",36),n(2),i(),a(3,"td",37),n(4),i(),a(5,"td",38),w(6,re,2,1,"span",39)(7,oe,2,0,"span",40),i(),a(8,"td",38),w(9,se,2,1,"span",41)(10,le,2,0,"span",40),i(),a(11,"td",42)(12,"div",43)(13,"button",44),u("click",function(){let o=f(t).$implicit,l=p(2);return S(l.registrarEntrada(o))}),n(14," \u23F0 Registrar Entrada "),i(),a(15,"button",45),u("click",function(){let o=f(t).$implicit,l=p(2);return S(l.registrarSalida(o))}),n(16," \u23F0 Registrar Salida "),i(),a(17,"button",46),u("click",function(){let o=f(t).$implicit,l=p(2);return S(l.registrarFalta(o))}),n(18," \u274C Registrar Falta "),i()()()()}if(s&2){let t=e.$implicit,r=p(2);d(2),N(" ",t.name," ",t.surname," "),d(2),D(" ",r.getRolDisplay(t.rol)," "),d(2),E(t.asistencia.hora_entrada?6:7),d(3),E(t.asistencia.hora_salida?9:10)}}function ce(s,e){if(s&1&&(a(0,"div",27)(1,"div",30)(2,"table",31)(3,"thead",32)(4,"tr")(5,"th",33),n(6,"Nombre"),i(),a(7,"th",33),n(8,"Rol"),i(),a(9,"th",33),n(10,"Hora Entrada"),i(),a(11,"th",33),n(12,"Hora Salida"),i(),a(13,"th",33),n(14,"Estado"),i()()(),a(15,"tbody",34),H(16,de,19,5,"tr",35,ae),i()()()()),s&2){let t=p();d(16),V(t.getEmpleadosConAsistencia())}}function me(s,e){s&1&&P(0,"is-error")}function ue(s,e){s&1&&P(0,"is-empty")}function ge(s,e){s&1&&(a(0,"div",51),P(1,"is-loading"),a(2,"p",53),n(3,"Cargando historial..."),i()())}function pe(s,e){if(s&1&&(a(0,"div",54)(1,"h3",55),n(2),i(),a(3,"div",56)(4,"div",57)(5,"div",58),n(6),i(),a(7,"div",59),n(8,"Total D\xEDas"),i()(),a(9,"div",57)(10,"div",60),n(11),i(),a(12,"div",59),n(13,"Presentes"),i()(),a(14,"div",57)(15,"div",61),n(16),i(),a(17,"div",59),n(18,"Ausentes"),i()(),a(19,"div",57)(20,"div",62),n(21),i(),a(22,"div",59),n(23,"Retrasos"),i()(),a(24,"div",57)(25,"div",63),n(26),i(),a(27,"div",59),n(28,"Salidas Tempranas"),i()()()()),s&2){let t=e.$implicit;d(2),N(" ",t.name," ",t.surname," "),d(4),v(t.stats.totalDias),d(5),v(t.stats.presentes),d(5),v(t.stats.ausentes),d(5),v(t.stats.retrasos),d(5),v(t.stats.salidasTempranas)}}function he(s,e){if(s&1&&(a(0,"div",52),H(1,pe,29,7,"div",54,ae),i()),s&2){let t=p(2);d(),V(t.historialData())}}function _e(s,e){s&1&&(a(0,"div",51)(1,"p",59),n(2,"No hay datos de historial disponibles"),i()())}function xe(s,e){if(s&1){let t=T();a(0,"div",28)(1,"div",47)(2,"div",48)(3,"h2",49),n(4,"\u{1F4CA} Historial de Asistencia"),i(),a(5,"button",50),u("click",function(){f(t);let o=p();return S(o.closeHistorialModal())}),n(6," \xD7 "),i()(),w(7,ge,4,0,"div",51)(8,he,3,0,"div",52)(9,_e,3,0,"div",51),i()()}if(s&2){let t=p();d(7),E(t.historialLoading()?7:t.historialData().length>0?8:9)}}function fe(s,e){if(s&1){let t=T();a(0,"div",66)(1,"div",69)(2,"p",70),n(3," Apunta la c\xE1mara al c\xF3digo QR del empleado "),i(),a(4,"div",71)(5,"p",72),n(6," \u26A0\uFE0F Aseg\xFArate de que el navegador tenga permisos para acceder a la c\xE1mara "),i(),a(7,"p",73),n(8," \u{1F4A1} El c\xF3digo QR debe contener el formato: user-id:123 "),i(),a(9,"p",74),n(10," \u{1F4F1} Si usas la app m\xF3vil, los permisos se solicitan autom\xE1ticamente "),i(),a(11,"p",75),n(12," \u{1F527} Para desarrollo: Si no funciona, intenta desde la app nativa "),i()()(),P(13,"video",76,0)(15,"canvas",77,1),a(17,"div",78)(18,"button",79),u("click",function(){f(t);let o=p(2);return S(o.startScanning())}),n(19," Iniciar Escaneo "),i(),a(20,"button",80),u("click",function(){f(t);let o=p(2);return S(o.stopScanning())}),n(21," Detener "),i()()()}}function Se(s,e){if(s&1){let t=T();a(0,"div",29)(1,"div",64)(2,"div",48)(3,"h2",49),n(4),i(),a(5,"button",50),u("click",function(){f(t);let o=p();return S(o.cerrarScannerModal())}),n(6," \xD7 "),i()(),a(7,"div",52)(8,"div",57)(9,"p",65),n(10),i()(),w(11,fe,22,0,"div",66),a(12,"div",57)(13,"button",67),u("click",function(){f(t);let o=p();return S(o.cerrarScannerModal())}),n(14," Cancelar "),i()(),a(15,"div",68)(16,"p"),n(17,"\u26A0\uFE0F Aseg\xFArate de que el navegador tenga permisos para acceder a la c\xE1mara"),i(),a(18,"p"),n(19,"\u{1F4A1} El c\xF3digo QR debe contener el formato: user-id:123"),i()()()()()}if(s&2){let t=p();d(4),D(" \u{1F4F1} Escanear QR - ",t.scannerType()==="entrada"?"Registrar Entrada":"Registrar Salida"," "),d(6),D(" Apunta la c\xE1mara al c\xF3digo QR del empleado para ",t.scannerType()==="entrada"?"registrar su entrada":"registrar su salida"," "),d(),E(t.scannerEnabled()?11:-1)}}var U=class s{_usersService=R(ee);_rolesService=R(J);_asistenciaService=R(ie);_cdr=R(B);reloadTrigger$=new G(0);asistenciaData=h([]);horaEntradaRestaurante=h("08:00");horaSalidaRestaurante=h("18:00");horaEntradaGlobal=h("08:00");horaSalidaGlobal=h("18:00");fechaSeleccionada=h(new Date().toISOString().split("T")[0]);showHistorialModal=h(!1);historialLoading=h(!1);historialData=h([]);showScannerModal=h(!1);scannerType=h("entrada");scannerEnabled=h(!0);stream=null;usersResource=L({request:()=>this.reloadTrigger$.value,loader:()=>this._usersService.getAll()});rolesResource=L({request:()=>this.reloadTrigger$.value,loader:()=>this._rolesService.getAll()});ngOnInit(){this.loadAsistenciaData()}loadAsistenciaData(){return b(this,null,function*(){try{let e=yield this._asistenciaService.getAll().toPromise();this.asistenciaData.set(e||[])}catch(e){console.error("Error loading asistencia data:",e),this.asistenciaData.set([])}})}getEmpleadosConAsistencia(){let e=this.usersResource.value()||[],t=this.rolesResource.value()||[];console.log("Users:",e),console.log("Roles:",t);let r=e.filter(o=>{let l=o.role?.name||o.UserEntity_role?.name||"",g=l.toLowerCase()==="user";return console.log("User:",o.name,o.surname,"Role:",l,"Is User Role:",g,"Filtered Out:",g),!g});return console.log("Filtered empleados (staff only):",r),r.map(o=>{let l=this.asistenciaData().find(x=>x.user_id===o.id&&x.fecha===this.fechaSeleccionada()),g=o.role?.name||o.UserEntity_role?.name||"Sin rol";return console.log("Empleado:",o.name,"Rol:",g,"Role object:",o.role,"UserEntity_role:",o.UserEntity_role),$(Q({},o),{rol:g,asistencia:l||{hora_entrada:null,hora_salida:null,estado:"sin_registro",fecha:this.fechaSeleccionada()}})})}getEstadoAsistencia(e){switch(e){case"presente":return"Presente";case"ausente":return"Ausente";case"sin_registro":return"Sin registro";case"ingreso_tarde":return"Ingreso Tarde";case"salida_temprana":return"Salida Temprana";default:return"Desconocido"}}getEstadoColor(e){switch(e){case"presente":return"bg-green-600";case"ausente":return"bg-red-600";case"sin_registro":return"bg-gray-600";case"ingreso_tarde":return"bg-yellow-600";case"salida_temprana":return"bg-orange-600";default:return"bg-gray-600"}}getRolDisplay(e){switch(e.toLowerCase()){case"admin":return"Administrador";case"waiter":return"Mesero";case"user":return"Cliente";default:return e}}getCurrentDate(){return new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}getEmpleadosPresentes(){return this.getEmpleadosConAsistencia().filter(e=>e.asistencia.estado==="presente").length}registrarEntrada(e){return b(this,null,function*(){let t=new Date().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),r=this.horaEntradaRestaurante(),[o,l]=r.split(":").map(Number),[g,x]=t.split(":").map(Number),C=o*60+l,y=g*60+x,c="presente";y>C&&(c="ingreso_tarde");try{let m=yield this._asistenciaService.getByUserAndDate(e.id,this.fechaSeleccionada()).toPromise();m?yield this._asistenciaService.update(m.id,{hora_entrada:t,estado:c}).toPromise():yield this._asistenciaService.create({user_id:e.id,fecha:this.fechaSeleccionada(),hora_entrada:t,estado:c}).toPromise(),yield this.loadAsistenciaData();let A=c==="ingreso_tarde"?" (Ingreso Tarde)":"";alert(`Entrada registrada para ${e.name} ${e.surname} a las ${t}${A}`)}catch(m){console.error("Error registrando entrada:",m),alert("Error al registrar la entrada")}})}registrarSalida(e){return b(this,null,function*(){let t=new Date().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),r=this.horaSalidaRestaurante(),[o,l]=r.split(":").map(Number),[g,x]=t.split(":").map(Number),C=o*60+l,y=g*60+x,c="presente";y<C&&(c="salida_temprana");try{let m=yield this._asistenciaService.getByUserAndDate(e.id,this.fechaSeleccionada()).toPromise();m?yield this._asistenciaService.update(m.id,{hora_salida:t,estado:c}).toPromise():yield this._asistenciaService.create({user_id:e.id,fecha:this.fechaSeleccionada(),hora_salida:t,estado:c}).toPromise(),yield this.loadAsistenciaData();let A=c==="salida_temprana"?" (Salida Temprana)":"";alert(`Salida registrada para ${e.name} ${e.surname} a las ${t}${A}`)}catch(m){console.error("Error registrando salida:",m),alert("Error al registrar la salida")}})}registrarFalta(e){if(confirm(`\xBFEst\xE1 seguro de registrar una falta para ${e.name} ${e.surname}?`)){let t=this.asistenciaData().findIndex(o=>o.id===e.id),r=[...this.asistenciaData()];t!==-1?r[t]=$(Q({},r[t]),{hora_entrada:null,hora_salida:null,estado:"ausente"}):r.push({id:e.id,user_id:e.id,hora_entrada:null,hora_salida:null,fecha:this.fechaSeleccionada(),estado:"ausente",created_at:new Date,updated_at:new Date}),this.asistenciaData.set(r),alert(`Falta registrada para ${e.name} ${e.surname}`)}}mostrarHistorial(){window.location.href="/admin/asistencia/historial"}closeHistorialModal(){this.showHistorialModal.set(!1),this.historialData.set([])}onFechaChange(){console.log("Fecha cambiada a:",this.fechaSeleccionada()),this.loadAsistenciaData()}fechaAnterior(){let e=new Date(this.fechaSeleccionada());e.setDate(e.getDate()-1),this.fechaSeleccionada.set(e.toISOString().split("T")[0]),this.onFechaChange()}fechaSiguiente(){let e=new Date(this.fechaSeleccionada());e.setDate(e.getDate()+1),this.fechaSeleccionada.set(e.toISOString().split("T")[0]),this.onFechaChange()}fechaHoy(){let e=new Date().toISOString().split("T")[0];this.fechaSeleccionada.set(e),this.onFechaChange()}actualizarHorariosGlobales(){console.log("Horarios globales actualizados:",{entrada:this.horaEntradaGlobal(),salida:this.horaSalidaGlobal()}),alert("Horarios globales actualizados. Los empleados sin horarios personalizados usar\xE1n estos horarios.")}abrirEscanerEntrada(){this.scannerType.set("entrada"),this.showScannerModal.set(!0),this.scannerEnabled.set(!0)}abrirEscanerSalida(){this.scannerType.set("salida"),this.showScannerModal.set(!0),this.scannerEnabled.set(!0)}cerrarScannerModal(){this.showScannerModal.set(!1),this.scannerEnabled.set(!1),this.stopScanning()}startScanning(){return b(this,null,function*(){try{if(console.log("Iniciando escaneo de QR con ML Kit..."),!(yield k.isSupported())){_.error("Escaneo no soportado",{description:"Este dispositivo no soporta el escaneo de c\xF3digos QR."});return}if((yield k.checkPermissions()).camera==="denied"&&(yield k.requestPermissions()).camera==="denied"){_.error("Permisos denegados",{description:"Se requieren permisos de c\xE1mara para escanear c\xF3digos QR."});return}let{barcodes:r}=yield k.scan();if(r.length>0){let o=r[0].rawValue;console.log("QR escaneado:",o),this.procesarQrEscaneado(o)}else _.info("Sin c\xF3digos detectados",{description:"No se detect\xF3 ning\xFAn c\xF3digo QR. Intente nuevamente."})}catch(e){console.error("Error en escaneo ML Kit:",e),_.error("Error en escaneo",{description:"Hubo un problema al escanear el c\xF3digo QR."})}})}stopScanning(){}onQrCodeResult(e){console.log("QR Code scanned:",e),this.procesarQrEscaneado(e)}onScannerError(e){console.error("Scanner error:",e),_.error("Error en el esc\xE1ner",{description:"Hubo un problema con la c\xE1mara. Verifica los permisos."})}procesarQrEscaneado(e){return b(this,null,function*(){try{let t=e.match(/^user-id:(\d+)$/);if(!t){_.error("C\xF3digo QR inv\xE1lido",{description:"El c\xF3digo QR escaneado no tiene el formato correcto."});return}let r=parseInt(t[1],10),l=(this.usersResource.value()||[]).find(g=>g.id===r);if(!l){_.error("Usuario no encontrado",{description:"El usuario del c\xF3digo QR no existe en el sistema."});return}this.cerrarScannerModal(),this.scannerType()==="entrada"?yield this.registrarEntradaDesdeQr(l):yield this.registrarSalidaDesdeQr(l)}catch(t){console.error("Error procesando QR:",t),_.error("Error procesando c\xF3digo QR",{description:"Hubo un problema al procesar el c\xF3digo QR escaneado."})}})}registrarEntradaDesdeQr(e){return b(this,null,function*(){let t=new Date().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),r=this.horaEntradaRestaurante(),[o,l]=r.split(":").map(Number),[g,x]=t.split(":").map(Number),C=o*60+l,y=g*60+x,c="presente";y>C&&(c="ingreso_tarde");try{let m=yield this._asistenciaService.getByUserAndDate(e.id,this.fechaSeleccionada()).toPromise();m?yield this._asistenciaService.update(m.id,{hora_entrada:t,estado:c}).toPromise():yield this._asistenciaService.create({user_id:e.id,fecha:this.fechaSeleccionada(),hora_entrada:t,estado:c}).toPromise(),yield this.loadAsistenciaData();let A=c==="ingreso_tarde"?" (Ingreso Tarde)":"";_.success("Entrada registrada",{description:`${e.name} ${e.surname} - ${t}${A}`})}catch(m){console.error("Error registrando entrada desde QR:",m),_.error("Error al registrar entrada",{description:"No se pudo registrar la entrada. Intente nuevamente."})}})}registrarSalidaDesdeQr(e){return b(this,null,function*(){let t=new Date().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),r=this.horaSalidaRestaurante(),[o,l]=r.split(":").map(Number),[g,x]=t.split(":").map(Number),C=o*60+l,y=g*60+x,c="presente";y<C&&(c="salida_temprana");try{let m=yield this._asistenciaService.getByUserAndDate(e.id,this.fechaSeleccionada()).toPromise();m?yield this._asistenciaService.update(m.id,{hora_salida:t,estado:c}).toPromise():yield this._asistenciaService.create({user_id:e.id,fecha:this.fechaSeleccionada(),hora_salida:t,estado:c}).toPromise(),yield this.loadAsistenciaData();let A=c==="salida_temprana"?" (Salida Temprana)":"";_.success("Salida registrada",{description:`${e.name} ${e.surname} - ${t}${A}`})}catch(m){console.error("Error registrando salida desde QR:",m),_.error("Error al registrar salida",{description:"No se pudo registrar la salida. Intente nuevamente."})}})}static \u0275fac=function(t){return new(t||s)};static \u0275cmp=j({type:s,selectors:[["admin-asistencia-page"]],decls:60,vars:9,consts:[["videoElement",""],["canvasElement",""],[1,"bg-gray-900","text-gray-100","min-h-screen","p-4","sm:p-6","overflow-x-hidden"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","gap-3","border-b-2","border-orange-500","p-4","bg-gray-800","shadow-md","mb-6","rounded-lg"],[1,"text-center","sm:text-left","text-2xl","sm:text-3xl","font-bold","text-white"],[1,"flex","gap-2"],[1,"btn","btn-sm","sm:btn-md","bg-green-500","hover:bg-green-600","text-white",3,"click"],[1,"btn","btn-sm","sm:btn-md","bg-blue-500","hover:bg-blue-600","text-white",3,"click"],[1,"btn","btn-sm","sm:btn-md","bg-gray-500","hover:bg-gray-600","text-white",3,"click"],[1,"bg-gray-800","rounded-lg","p-4","mb-6"],[1,"flex","flex-col","sm:flex-row","sm:justify-between","sm:items-center","gap-4"],[1,"text-lg","font-semibold","text-orange-400"],[1,"text-gray-300","text-sm"],[1,"text-right"],[1,"text-gray-400","text-sm"],[1,"text-green-400","text-sm"],[1,"text-lg","font-semibold","text-orange-400","mb-4"],[1,"flex","flex-col","sm:flex-row","gap-4","items-start","sm:items-center"],[1,"flex-1"],[1,"block","text-sm","font-medium","text-gray-300","mb-2"],["type","date",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","focus:outline-none","focus:ring-2","focus:ring-orange-500",3,"ngModelChange","change","ngModel"],["title","D\xEDa anterior",1,"px-4","py-2","bg-gray-600","hover:bg-gray-700","text-white","rounded-md","font-medium","transition",3,"click"],[1,"px-4","py-2","bg-orange-500","hover:bg-orange-600","text-white","rounded-md","font-medium","transition",3,"click"],["title","D\xEDa siguiente",1,"px-4","py-2","bg-gray-600","hover:bg-gray-700","text-white","rounded-md","font-medium","transition",3,"click"],[1,"text-sm","text-gray-400","mt-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","time",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","focus:outline-none","focus:ring-2","focus:ring-orange-500",3,"ngModelChange","change","ngModel"],[1,"bg-gray-800","rounded-lg","overflow-hidden"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"fixed","inset-0","bg-black","bg-opacity-75","flex","items-center","justify-center","z-50"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-orange-500/10"],[1,"px-4","py-3","text-left","text-xs","font-medium","text-orange-400","uppercase","tracking-wider"],[1,"divide-y","divide-gray-600"],[1,"hover:bg-gray-700","transition-colors"],[1,"px-4","py-3","text-sm","text-white","font-medium"],[1,"px-4","py-3","text-sm","text-gray-300"],[1,"px-4","py-3","text-sm","text-white"],[1,"text-green-400"],[1,"text-gray-500"],[1,"text-blue-400"],[1,"px-4","py-3","text-sm"],[1,"flex","flex-col","gap-1"],["title","Registrar Entrada",1,"px-3","py-1","bg-green-600","hover:bg-green-700","text-white","rounded","text-xs","font-medium","transition-all","w-full",3,"click"],["title","Registrar Salida",1,"px-3","py-1","bg-blue-600","hover:bg-blue-700","text-white","rounded","text-xs","font-medium","transition-all","w-full",3,"click"],["title","Registrar Falta",1,"px-3","py-1","bg-red-600","hover:bg-red-700","text-white","rounded","text-xs","font-medium","transition-all","w-full",3,"click"],[1,"bg-gray-800","rounded-lg","p-6","max-w-4xl","w-full","mx-4","max-h-[80vh]","overflow-y-auto"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-bold","text-white"],[1,"text-gray-400","hover:text-white","text-2xl",3,"click"],[1,"text-center","py-8"],[1,"space-y-4"],[1,"text-gray-300","mt-2"],[1,"bg-gray-700","rounded-lg","p-4"],[1,"text-lg","font-semibold","text-orange-400","mb-2"],[1,"grid","grid-cols-2","md:grid-cols-5","gap-4","text-sm"],[1,"text-center"],[1,"text-2xl","font-bold","text-blue-400"],[1,"text-gray-300"],[1,"text-2xl","font-bold","text-green-400"],[1,"text-2xl","font-bold","text-red-400"],[1,"text-2xl","font-bold","text-yellow-400"],[1,"text-2xl","font-bold","text-orange-400"],[1,"bg-gray-800","rounded-lg","p-6","max-w-2xl","w-full","mx-4"],[1,"text-gray-300","mb-4"],[1,"bg-black","rounded-lg","overflow-hidden","p-4"],[1,"px-4","py-2","bg-gray-600","hover:bg-gray-700","text-white","rounded-md","font-medium","transition",3,"click"],[1,"text-sm","text-gray-400","text-center"],[1,"mb-4","text-center"],[1,"text-gray-300","text-sm","mb-2"],[1,"bg-yellow-900","border","border-yellow-600","rounded","p-2","mb-4"],[1,"text-yellow-200","text-xs"],[1,"text-yellow-300","text-xs","mt-1"],[1,"text-blue-300","text-xs","mt-1"],[1,"text-green-300","text-xs","mt-1"],["autoplay","","playsinline","","muted","",1,"w-full","rounded"],[1,"hidden"],[1,"mt-4","text-center"],[1,"px-4","py-2","bg-green-500","hover:bg-green-600","text-white","rounded-md","font-medium","transition","mr-2",3,"click"],[1,"px-4","py-2","bg-red-500","hover:bg-red-600","text-white","rounded-md","font-medium","transition",3,"click"]],template:function(t,r){t&1&&(a(0,"div",2)(1,"div",3)(2,"h1",4),n(3," \u23F0 Control de Asistencia "),i(),a(4,"div",5)(5,"button",6),u("click",function(){return r.abrirEscanerEntrada()}),n(6," \u{1F4F1} Registrar Entrada "),i(),a(7,"button",7),u("click",function(){return r.abrirEscanerSalida()}),n(8," \u{1F4F1} Registrar Salida "),i(),a(9,"button",8),u("click",function(){return r.mostrarHistorial()}),n(10," \u{1F4CA} Historial "),i()()(),a(11,"div",9)(12,"div",10)(13,"div")(14,"h2",11),n(15,"Empleados del D\xEDa"),i(),a(16,"p",12),n(17),i()(),a(18,"div",13)(19,"p",14),n(20),i(),a(21,"p",15),n(22),i()()()(),a(23,"div",9)(24,"h2",16),n(25,"\u{1F4C5} Seleccionar Fecha"),i(),a(26,"div",17)(27,"div",18)(28,"label",19),n(29,"Fecha de Asistencia"),i(),a(30,"input",20),M("ngModelChange",function(l){return I(r.fechaSeleccionada,l)||(r.fechaSeleccionada=l),l}),u("change",function(){return r.onFechaChange()}),i()(),a(31,"div",5)(32,"button",21),u("click",function(){return r.fechaAnterior()}),n(33," \u2190 Anterior "),i(),a(34,"button",22),u("click",function(){return r.fechaHoy()}),n(35," Hoy "),i(),a(36,"button",23),u("click",function(){return r.fechaSiguiente()}),n(37," Siguiente \u2192 "),i()()(),a(38,"p",24),n(39,"Selecciona la fecha para registrar o consultar asistencias de empleados."),i()(),a(40,"div",9)(41,"h2",16),n(42,"\u23F0 Configuraci\xF3n de Horarios"),i(),a(43,"div",25)(44,"div")(45,"label",19),n(46,"Hora de Entrada Global"),i(),a(47,"input",26),M("ngModelChange",function(l){return I(r.horaEntradaGlobal,l)||(r.horaEntradaGlobal=l),l}),u("change",function(){return r.actualizarHorariosGlobales()}),i()(),a(48,"div")(49,"label",19),n(50,"Hora de Salida Global"),i(),a(51,"input",26),M("ngModelChange",function(l){return I(r.horaSalidaGlobal,l)||(r.horaSalidaGlobal=l),l}),u("change",function(){return r.actualizarHorariosGlobales()}),i()()(),a(52,"p",24),n(53,"Estos horarios se aplicar\xE1n a todos los empleados que no tengan horarios personalizados."),i()(),w(54,ne,1,0,"is-loading")(55,ce,18,0,"div",27)(56,me,1,0,"is-error")(57,ue,1,0,"is-empty"),i(),w(58,xe,10,1,"div",28)(59,Se,20,3,"div",29)),t&2&&(d(17),D("Fecha: ",r.getCurrentDate(),""),d(3),D("Total empleados: ",r.getEmpleadosConAsistencia().length,""),d(2),D("Presentes: ",r.getEmpleadosPresentes(),""),d(8),F("ngModel",r.fechaSeleccionada),d(17),F("ngModel",r.horaEntradaGlobal),d(4),F("ngModel",r.horaSalidaGlobal),d(3),E(r.usersResource.isLoading()||r.rolesResource.isLoading()?54:r.usersResource.hasValue()&&r.rolesResource.hasValue()?55:r.usersResource.error()||r.rolesResource.error()?56:57),d(4),E(r.showHistorialModal()?58:-1),d(),E(r.showScannerModal()?59:-1))},dependencies:[W,K,z,q,O,X,Y,Z],encapsulation:2,changeDetection:0})},Ge=U;export{U as AdminAsistenciaPageComponent,Ge as default};
