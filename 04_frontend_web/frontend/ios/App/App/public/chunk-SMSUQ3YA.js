import{a as w}from"./chunk-VC3IURHL.js";import{a as S,b as a,c as F,d as C,g as E,i as R,j as _,q as A,s as I}from"./chunk-L57FSASQ.js";import{a as n}from"./chunk-7IX7VPDF.js";import"./chunk-DLFABNFZ.js";import{a as y}from"./chunk-YKSGIHVP.js";import{d as x,e as b}from"./chunk-BBMTBTDA.js";import"./chunk-IJHKA2LB.js";import"./chunk-IBNRR53B.js";import{Ja as f,R as s,Ua as h,bb as t,cb as o,db as m,kb as v,ma as d,ub as r,xa as p}from"./chunk-GQXGSY3T.js";import"./chunk-YEWEO3AL.js";var c=class g{_router=s(x);_authService=s(w);_formBuilder=s(A);hasError=d(!1);isPosting=d(!1);loginForm=this._formBuilder.group({email:["",[a.required,a.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]],password:["",[a.required,a.minLength(8)]]});onSubmit(){try{if(console.log("\u{1F680} Iniciando proceso de login..."),console.log("\u{1F4F1} User Agent:",typeof window<"u"&&window.navigator?window.navigator.userAgent:"Unknown"),console.log("\u{1F310} URL actual:",window.location.href),this.loginForm.invalid){console.log("\u274C Formulario inv\xE1lido:",this.loginForm.errors),n.error("Inicio de Sesi\xF3n Fallido",{duration:2e3,description:"Por Favor, Completa Todos los Campos Requeridos"});return}let i={email:this.loginForm.controls.email.value,password:this.loginForm.controls.password.value};console.log("\u{1F4E4} Datos a enviar:",{email:i.email,password:"***"}),console.log("\u{1F517} API URL:",`${y.apiUrl}/auth/login`),this.isPosting.set(!0),this._authService.login(i).subscribe({next:e=>{if(console.log("\u2705 Respuesta del servicio de auth:",e),e){n.success("Inicio de Sesi\xF3n Exitoso",{duration:2e3,description:"Bienvenido de Nuevo"});let u=this._authService.user()?.role_id===4?"/waiter":"/";console.log("\u{1F500} Redirigiendo a:",u),this._router.navigateByUrl(u);return}console.log("\u274C Login fallido - credenciales incorrectas"),n.error("Inicio de Sesi\xF3n Fallido",{duration:2e3,description:"Credenciales Incorrectas"}),this.isPosting.set(!1)},error:e=>{console.error("\u{1F4A5} Error en login:",e),console.error("\u{1F50D} Detalles del error:",{status:e.status,statusText:e.statusText,message:e.message,url:e.url}),n.error("Error de Conexi\xF3n",{duration:4e3,description:`Error ${e.status||"desconocido"}: ${e.message||"No se pudo conectar con el servidor"}`}),this.isPosting.set(!1)}})}catch(i){console.error("\u{1F4A5} Error inesperado:",i),n.error("Error Inesperado",{duration:3e3,description:"Ha ocurrido un error inesperado. Revisa la consola."})}}static \u0275fac=function(e){return new(e||g)};static \u0275cmp=f({type:g,selectors:[["auth-login-page"]],decls:20,vars:1,consts:[[1,"min-h-[70vh]","flex","items-center","justify-center","bg-gray-900","py-2","px-4"],[1,"w-full","max-w-sm","bg-gray-800","rounded-xl","shadow-2xl","p-8","border","border-gray-700"],[1,"text-3xl","font-bold","text-center","text-orange-500","mb-8"],[1,"space-y-6",3,"ngSubmit","formGroup"],["for","email",1,"block","text-sm","font-medium","text-gray-300","mb-2"],["type","email","placeholder","tu@email.com","formControlName","email",1,"w-full","px-4","py-3","bg-gray-900","border","border-gray-600","rounded-lg","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500","focus:border-transparent","transition-all","duration-300"],["for","password",1,"block","text-sm","font-medium","text-gray-300","mb-2"],["type","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","formControlName","password",1,"w-full","px-4","py-3","bg-gray-900","border","border-gray-600","rounded-lg","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500","focus:border-transparent","transition-all","duration-300"],["type","submit",1,"w-full","bg-orange-500","hover:bg-orange-600","text-white","font-semibold","py-3","px-4","rounded-lg","shadow-lg","hover:shadow-xl","transition-all","duration-300","transform","hover:scale-105","mt-8"],[1,"text-center","mt-6"],[1,"text-sm","text-gray-400"],["routerLink","/auth/register",1,"text-sm","font-medium","text-orange-500","hover:text-orange-400","transition-colors","duration-300"]],template:function(e,l){e&1&&(t(0,"div",0)(1,"div",1)(2,"h2",2),r(3," Iniciar Sesi\xF3n "),o(),t(4,"form",3),v("ngSubmit",function(){return l.onSubmit()}),t(5,"div")(6,"label",4),r(7," Correo Electr\xF3nico "),o(),m(8,"input",5),o(),t(9,"div")(10,"label",6),r(11," Contrase\xF1a "),o(),m(12,"input",7),o(),t(13,"button",8),r(14," Ingresar "),o()(),t(15,"div",9)(16,"span",10),r(17,"\xBFNo tienes cuenta? "),o(),t(18,"a",11),r(19,"Reg\xEDstrate"),o()()()()),e&2&&(p(4),h("formGroup",l.loginForm))},dependencies:[I,E,S,F,C,R,_,b],encapsulation:2,changeDetection:0})},M=c;export{c as AuthLoginPageComponent,M as default};
