import{a as V}from"./chunk-X6DMPGQL.js";import"./chunk-YKSGIHVP.js";import{d as T}from"./chunk-BBMTBTDA.js";import"./chunk-IJHKA2LB.js";import{g as R,i as P,j as A,k as F,l as O,m as I}from"./chunk-IBNRR53B.js";import{Fb as w,Gb as u,Hb as y,Ib as E,Ja as S,Nb as k,Oa as b,R as C,Ua as m,Z as _,_ as x,bb as t,cb as i,db as p,hb as h,kb as g,lb as c,ub as a,vb as v,wb as f,xa as s}from"./chunk-GQXGSY3T.js";import"./chunk-YEWEO3AL.js";var $=(l,n,e,o)=>({"bg-yellow-600 text-white":l,"bg-green-600 text-white":n,"bg-red-600 text-white":e,"bg-blue-600 text-white":o});function D(l,n){l&1&&(t(0,"div",12),p(1,"span",13),t(2,"span",14),a(3,"Cargando mesas..."),i()())}function B(l,n){if(l&1&&(t(0,"div",15),p(1,"i",16),t(2,"span"),a(3),i()()),l&2){let e=c();s(3),v(e.errorMessage)}}function N(l,n){if(l&1&&(t(0,"p")(1,"strong"),a(2,"Ubicaci\xF3n:"),i(),a(3),i()),l&2){let e=c().$implicit;s(3),f(" ",e.ubicacion," ")}}function L(l,n){if(l&1){let e=h();t(0,"div",22)(1,"div",23)(2,"div",24)(3,"h3",25),a(4),i(),t(5,"div",26)(6,"div",27),p(7,"i",28),i(),t(8,"ul",29)(9,"li",30)(10,"span",31),a(11,"Cambiar Estado"),i()(),t(12,"li")(13,"button",32),g("click",function(){let r=_(e).$implicit,d=c(2);return x(d.cambiarEstadoMesa(r.id,"libre"))}),p(14,"i",33),a(15," Marcar como Libre "),i()(),t(16,"li")(17,"button",32),g("click",function(){let r=_(e).$implicit,d=c(2);return x(d.cambiarEstadoMesa(r.id,"reservada"))}),p(18,"i",34),a(19," Marcar como Reservada "),i()(),t(20,"li")(21,"button",32),g("click",function(){let r=_(e).$implicit,d=c(2);return x(d.cambiarEstadoMesa(r.id,"ocupada"))}),p(22,"i",35),a(23," Marcar como Ocupada "),i()(),t(24,"li")(25,"button",32),g("click",function(){let r=_(e).$implicit,d=c(2);return x(d.cambiarEstadoMesa(r.id,"mantenimiento"))}),p(26,"i",36),a(27," Mantenimiento "),i()(),p(28,"li",37),t(29,"li",30)(30,"span",31),a(31,"Acciones"),i()(),t(32,"li")(33,"button",38),g("click",function(){let r=_(e).$implicit,d=c(2);return x(d.editarMesa(r.id))}),p(34,"i",39),a(35," Editar Mesa "),i()(),t(36,"li")(37,"button",40),g("click",function(){let r=_(e).$implicit,d=c(2);return x(d.eliminarMesa(r.id))}),p(38,"i",41),a(39," Eliminar Mesa "),i()()()()(),t(40,"div",42)(41,"p")(42,"strong"),a(43,"Capacidad:"),i(),a(44),i(),t(45,"p")(46,"strong"),a(47,"Estado:"),i(),t(48,"span",43),a(49),u(50,"titlecase"),i()(),b(51,N,4,1,"p",11),i()()()}if(l&2){let e=n.$implicit,o=c(2);s(4),f("Mesa ",e.numero,""),s(9),m("disabled",e.estado==="libre"),s(4),m("disabled",e.estado==="reservada"),s(4),m("disabled",e.estado==="ocupada"),s(4),m("disabled",e.estado==="mantenimiento"),s(19),f(" ",e.capacidad," personas"),s(4),m("ngClass",o.getEstadoClass(e.estado)),s(),f(" ",y(50,9,e.estado)," "),s(2),m("ngIf",e.ubicacion)}}function j(l,n){if(l&1){let e=h();t(0,"div",44),p(1,"i",45),t(2,"h3",46),a(3,"No hay mesas registradas"),i(),t(4,"p",47),a(5,"Comienza creando tu primera mesa para gestionar las reservas."),i(),t(6,"button",48),g("click",function(){_(e);let r=c(2);return x(r.crearMesa())}),p(7,"i",49),a(8,"Crear Primera Mesa "),i()()}}function H(l,n){if(l&1&&(t(0,"div",17)(1,"h2",18),a(2," Estado de las Mesas "),i(),t(3,"div",19),b(4,L,52,11,"div",20),i(),b(5,j,9,0,"div",21),i()),l&2){let e=c();s(4),m("ngForOf",e.mesas)("ngForTrackBy",e.trackByMesaId),s(),m("ngIf",e.mesas.length===0&&!e.isLoading)}}function z(l,n){if(l&1){let e=h();t(0,"div",57)(1,"div",58)(2,"div",59)(3,"span",60),a(4,"Mesa:"),i(),t(5,"span"),a(6),i()(),t(7,"span",61),a(8),u(9,"titlecase"),i()(),t(10,"div",62)(11,"div")(12,"span",63),a(13,"Cliente"),i(),t(14,"span",64),a(15),i()(),t(16,"div")(17,"span",63),a(18,"Tel\xE9fono"),i(),t(19,"span",64),a(20),i()(),t(21,"div")(22,"span",63),a(23,"Fecha"),i(),t(24,"span",64),a(25),u(26,"date"),i()(),t(27,"div")(28,"span",63),a(29,"Hora"),i(),t(30,"span",64),a(31),u(32,"date"),i()(),t(33,"div")(34,"span",63),a(35,"Personas"),i(),t(36,"span",64),a(37),i()()(),t(38,"div",65)(39,"button",66),g("click",function(){let r=_(e).$implicit,d=c(2);return x(d.editarReserva(r.reserva_id))}),a(40," \u270F\uFE0F Editar "),i(),t(41,"button",67),g("click",function(){let r=_(e).$implicit,d=c(2);return x(d.eliminarReserva(r.reserva_id))}),a(42," \u{1F5D1}\uFE0F Eliminar "),i()()()}if(l&2){let e=n.$implicit;s(6),v((e.mesa==null?null:e.mesa.numero)||"N/A"),s(),m("ngClass",w(16,$,e.estado==="pendiente",e.estado==="confirmado",e.estado==="cancelada",e.estado==="completada")),s(),f(" ",y(9,8,e.estado)," "),s(7),v(e.cliente_nombre),s(5),v(e.cliente_telefono||"N/A"),s(5),v(E(26,10,e.fecha_hora,"dd/MM/yyyy")),s(6),v(E(32,13,e.fecha_hora,"HH:mm")),s(6),v(e.numero_personas)}}function U(l,n){if(l&1){let e=h();t(0,"tr",68)(1,"td",69),a(2),i(),t(3,"td",69),a(4),i(),t(5,"td",69),a(6),i(),t(7,"td",69),a(8),u(9,"date"),i(),t(10,"td",69),a(11),u(12,"date"),i(),t(13,"td",69),a(14),i(),t(15,"td",69)(16,"span",70),a(17),u(18,"titlecase"),i()(),t(19,"td",69)(20,"div",71)(21,"button",72),g("click",function(){let r=_(e).$implicit,d=c(2);return x(d.editarReserva(r.reserva_id))}),a(22," \u270F\uFE0F "),i(),t(23,"button",73),g("click",function(){let r=_(e).$implicit,d=c(2);return x(d.eliminarReserva(r.reserva_id))}),a(24," \u{1F5D1}\uFE0F "),i()()()()}if(l&2){let e=n.$implicit;s(2),v((e.mesa==null?null:e.mesa.numero)||"N/A"),s(2),v(e.cliente_nombre),s(2),v(e.cliente_telefono||"N/A"),s(2),v(E(9,8,e.fecha_hora,"dd/MM/yyyy")),s(3),v(E(12,11,e.fecha_hora,"HH:mm")),s(3),v(e.numero_personas),s(2),m("ngClass",w(16,$,e.estado==="pendiente",e.estado==="confirmado",e.estado==="cancelada",e.estado==="completada")),s(),f(" ",y(18,14,e.estado)," ")}}function q(l,n){if(l&1&&(t(0,"div")(1,"h2",18),a(2,"Reservas Activas"),i(),t(3,"div",50),b(4,z,43,21,"div",51),i(),t(5,"div",52)(6,"table",53)(7,"thead")(8,"tr",54)(9,"th",55),a(10,"Mesa"),i(),t(11,"th",55),a(12,"Cliente"),i(),t(13,"th",55),a(14,"Tel\xE9fono"),i(),t(15,"th",55),a(16,"Fecha"),i(),t(17,"th",55),a(18,"Hora"),i(),t(19,"th",55),a(20,"Personas"),i(),t(21,"th",55),a(22,"Estado"),i(),t(23,"th",55),a(24,"Acciones"),i()()(),t(25,"tbody"),b(26,U,25,21,"tr",56),i()()()()),l&2){let e=c();s(4),m("ngForOf",e.reservas)("ngForTrackBy",e.trackByReservaId),s(22),m("ngForOf",e.reservas)("ngForTrackBy",e.trackByReservaId)}}var M=class l{_router=C(T);_reservasService=C(V);_cdr=C(k);mesas=[];reservas=[];isLoading=!1;errorMessage="";ngOnInit(){console.log("\u{1F680} AdminReservasPageComponent: Inicializando..."),this.loadMesas(),this.loadReservas()}loadMesas(){this.isLoading=!0,this.errorMessage="",this._reservasService.getMesas().subscribe({next:n=>{this.mesas=n,this.isLoading=!1,this._cdr.markForCheck(),console.log("\u2705 Mesas cargadas desde el backend:",n.length)},error:n=>{this.isLoading=!1,this._cdr.markForCheck(),n.status===401?this.errorMessage="No tienes permisos para ver las mesas. Inicia sesi\xF3n nuevamente.":n.status===0||!n.status?this.errorMessage="No se pudo conectar al servidor. Verifica tu conexi\xF3n a internet.":this.errorMessage=`Error al cargar las mesas: ${n.message||"Error desconocido"}`,console.error("\u274C Error cargando mesas:",n)}})}loadReservas(){this._reservasService.getReservas().subscribe({next:n=>{console.log("\u{1F50D} DEBUG: Tipo de datos recibidos:",typeof n),console.log("\u{1F50D} DEBUG: Es array:",Array.isArray(n)),console.log("\u{1F50D} DEBUG: Datos completos:",n),Array.isArray(n)?(this.reservas=n,console.log("\u2705 Reservas cargadas desde el backend:",n.length)):(console.error("\u274C ERROR: Los datos recibidos no son un array:",n),this.reservas=[]),this._cdr.markForCheck()},error:n=>{console.error("\u274C Error cargando reservas:",n),this.reservas=[]}})}trackByMesaId(n,e){return e.id}trackByReservaId(n,e){return e.reserva_id}getEstadoClass(n){switch(n){case"libre":return"badge-success";case"reservada":return"badge-warning";case"ocupada":return"badge-info";case"mantenimiento":return"badge-error";default:return"badge-neutral"}}getReservaEstadoClass(n){switch(n){case"pendiente":return"badge-warning";case"confirmado":return"badge-success";case"cancelada":return"badge-error";case"completada":return"badge-info";default:return"badge-neutral"}}cambiarEstadoMesa(n,e){console.log(`\u{1F504} Cambiando estado de mesa ${n} a ${e}`),this._reservasService.cambiarEstadoMesa(n,e).subscribe({next:()=>{let o=this.mesas.find(r=>r.id===n);o&&(o.estado=e,this._cdr.markForCheck(),console.log(`\u2705 Estado actualizado: Mesa ${o.numero} ahora est\xE1 ${e}`))},error:o=>{console.error("\u274C Error cambiando estado de mesa:",o),alert("Error al cambiar el estado de la mesa. Intente nuevamente.")}})}editarMesa(n){console.log("\u270F\uFE0F Editando mesa:",n),this._router.navigate(["/admin/reservas-mesas/edit-mesa",n])}eliminarMesa(n){let e=this.mesas.find(r=>r.id===n);if(!e){console.error("\u274C Mesa no encontrada:",n);return}if(this.reservas.some(r=>r.mesa_id===n&&(r.estado==="pendiente"||r.estado==="confirmado"))){alert(`No se puede eliminar la mesa ${e.numero} porque tiene reservas activas.

Cancele o complete todas las reservas de esta mesa antes de eliminarla.`);return}confirm(`\xBFEst\xE1 seguro de que desea eliminar la mesa ${e.numero}?

Esta acci\xF3n no se puede deshacer.`)&&(console.log("\u{1F5D1}\uFE0F Eliminando mesa:",n),this._reservasService.deleteMesa(n).subscribe({next:()=>{this.mesas=this.mesas.filter(r=>r.id!==n),this._cdr.markForCheck(),console.log("\u2705 Mesa eliminada correctamente")},error:r=>{console.error("\u274C Error eliminando mesa:",r);let d=r.error?.error||"Error desconocido";alert(`Error al eliminar la mesa: ${d}`)}}))}editarReserva(n){console.log("\u270F\uFE0F Editando reserva:",n),this._router.navigate(["/admin/reservas-mesas/edit-reserva",n])}eliminarReserva(n){let e=this.reservas.find(o=>o.reserva_id===n);if(!e){console.error("\u274C Reserva no encontrada:",n);return}confirm(`\xBFEst\xE1 seguro de que desea ELIMINAR completamente la reserva de ${e.cliente_nombre}?

Esta acci\xF3n no se puede deshacer y borrar\xE1 permanentemente la reserva de la base de datos.`)&&(console.log("\u{1F5D1}\uFE0F Eliminando reserva:",n),this._reservasService.deleteReserva(n).subscribe({next:()=>{this.reservas=this.reservas.filter(o=>o.reserva_id!==n),this._cdr.markForCheck(),console.log("\u2705 Reserva eliminada correctamente")},error:o=>{console.error("\u274C Error eliminando reserva:",o),alert("Error al eliminar la reserva. Intente nuevamente.")}}))}crearMesa(){console.log("\u2795 Navegando a crear mesa..."),this._router.navigate(["/admin/reservas-mesas/create-mesa"])}crearReserva(){console.log("\u{1F4C5} Navegando a crear reserva..."),this._router.navigate(["/admin/reservas-mesas/create-reserva"])}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=S({type:l,selectors:[["admin-reservas-page"]],decls:17,vars:4,consts:[[1,"p-4","sm:p-6","overflow-x-hidden","max-w-full"],[1,"w-full","flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","items-stretch","gap-3","sm:gap-2","mb-4","sm:mb-6","min-w-0"],[1,"w-full","text-2xl","sm:text-3xl","font-bold","text-primary","break-words","text-center","sm:text-left"],[1,"flex","w-full","sm:w-auto","flex-col","sm:flex-row","gap-2","sm:justify-end"],[1,"btn","btn-sm","sm:btn-md","btn-primary","w-full","sm:w-auto","max-w-full","whitespace-normal","sm:whitespace-nowrap",3,"click"],[1,"fas","fa-plus","mr-2","hidden","sm:inline"],[1,"btn","btn-sm","sm:btn-md","btn-secondary","w-full","sm:w-auto","max-w-full","whitespace-normal","sm:whitespace-nowrap",3,"click"],[1,"fas","fa-calendar-plus","mr-2","hidden","sm:inline"],["class","flex justify-center items-center py-8",4,"ngIf"],["class","alert alert-error mb-6",4,"ngIf"],["class","mb-8",4,"ngIf"],[4,"ngIf"],[1,"flex","justify-center","items-center","py-8"],[1,"loading","loading-spinner","loading-lg"],[1,"ml-2"],[1,"alert","alert-error","mb-6"],[1,"fas","fa-exclamation-triangle"],[1,"mb-8"],[1,"text-xl","sm:text-2xl","font-bold","mb-3","sm:mb-4","text-primary"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-3","sm:gap-4"],["class","card bg-base-100 shadow-lg",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center py-10",4,"ngIf"],[1,"card","bg-base-100","shadow-lg"],[1,"card-body","p-4"],[1,"flex","justify-between","items-center","mb-2"],[1,"card-title","text-base","sm:text-lg"],[1,"dropdown","dropdown-end"],["tabindex","0",1,"btn","btn-ghost","btn-xs","sm:btn-sm"],[1,"fas","fa-ellipsis-v"],["tabindex","0",1,"dropdown-content","menu","p-2","shadow","bg-base-100","rounded-box","w-52"],[1,"menu-title"],[1,"text-xs","font-semibold","text-base-content/70"],[1,"btn","btn-sm","btn-ghost",3,"click","disabled"],[1,"fas","fa-check-circle","text-success"],[1,"fas","fa-clock","text-warning"],[1,"fas","fa-users","text-info"],[1,"fas","fa-tools","text-error"],[1,"divider"],[1,"btn","btn-sm","btn-ghost",3,"click"],[1,"fas","fa-edit","text-primary"],[1,"btn","btn-sm","btn-ghost","text-error",3,"click"],[1,"fas","fa-trash"],[1,"space-y-1","text-sm","sm:text-base"],[1,"badge",3,"ngClass"],[1,"text-center","py-10"],[1,"fas","fa-table","text-6xl","text-base-300","mb-4"],[1,"text-xl","font-semibold","mb-2"],[1,"text-base-content/70","mb-4"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","mr-2"],[1,"md:hidden","space-y-3"],["class","bg-gray-800 rounded-lg border border-gray-700 p-4 shadow",4,"ngFor","ngForOf","ngForTrackBy"],[1,"hidden","md:block","overflow-x-auto"],[1,"!table","!w-full","!bg-gray-800","!rounded-lg","!overflow-hidden"],[1,"!bg-gray-700","!text-orange-400"],[1,"!px-4","!py-3","!text-left"],["class","!border-b !border-gray-700 !bg-white !text-gray-900 !hover:bg-white",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-gray-800","rounded-lg","border","border-gray-700","p-4","shadow"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-sm","text-gray-300"],[1,"font-semibold","text-orange-400"],[1,"px-2","py-1","rounded-full","text-[11px]","font-semibold",3,"ngClass"],[1,"grid","grid-cols-2","gap-2","text-sm","text-gray-300"],[1,"block","text-gray-400"],[1,"font-medium"],[1,"flex","justify-end","gap-2","mt-3"],["title","Editar reserva",1,"bg-orange-500","hover:bg-orange-600","text-white","px-3","py-1.5","rounded","text-sm","transition",3,"click"],["title","Eliminar reserva",1,"bg-red-600","hover:bg-red-700","text-white","px-3","py-1.5","rounded","text-sm","transition",3,"click"],[1,"!border-b","!border-gray-700","!bg-white","!text-gray-900","!hover:bg-white"],[1,"!px-4","!py-3"],[1,"px-2","py-1","rounded-full","text-xs","font-semibold",3,"ngClass"],[1,"flex","gap-1"],["title","Editar reserva",1,"bg-orange-500","hover:bg-orange-600","text-white","px-2","py-1","rounded","text-sm","transition",3,"click"],["title","Eliminar reserva",1,"bg-red-600","hover:bg-red-700","text-white","px-2","py-1","rounded","text-sm","transition",3,"click"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),a(3," Sistema de Reservas de Mesas "),i(),t(4,"div",3)(5,"button",4),g("click",function(){return o.crearMesa()}),p(6,"i",5),t(7,"span"),a(8,"Nueva Mesa"),i()(),t(9,"button",6),g("click",function(){return o.crearReserva()}),p(10,"i",7),t(11,"span"),a(12,"Nueva Reserva"),i()()()(),b(13,D,4,0,"div",8)(14,B,4,1,"div",9)(15,H,6,3,"div",10)(16,q,27,4,"div",11),i()),e&2&&(s(13),m("ngIf",o.isLoading),s(),m("ngIf",o.errorMessage),s(),m("ngIf",!o.isLoading),s(),m("ngIf",!o.isLoading))},dependencies:[I,R,P,A,F,O],styles:["[_nghost-%COMP%]   table[_ngcontent-%COMP%]{background-color:#1f2937!important;border-radius:.5rem!important;overflow:hidden!important}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#374151!important;color:#fb923c!important}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#fff!important;color:#111827!important;border-bottom:1px solid rgb(75 85 99)!important}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#fff!important}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem!important;text-align:left!important}[_nghost-%COMP%]   .badge[_ngcontent-%COMP%]{background-color:initial!important;color:initial!important;border-radius:9999px!important;padding:.25rem .5rem!important;font-size:.75rem!important;font-weight:600!important}"],changeDetection:0})},ie=M;export{M as AdminReservasPageComponent,ie as default};
