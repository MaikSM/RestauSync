import{a as Y}from"./chunk-OCVFMPQC.js";import{a as j,b as u,c as B,d as $,g as U,h as z,i as H,j as J,k as K,l as L,m as Q,q as W,s as X}from"./chunk-L57FSASQ.js";import"./chunk-YKSGIHVP.js";import{d as R}from"./chunk-BBMTBTDA.js";import"./chunk-IJHKA2LB.js";import{i as V,j as O,m as G}from"./chunk-IBNRR53B.js";import{Ja as T,Nb as k,Oa as c,R as v,Ua as m,Va as g,Z as E,_ as w,bb as n,cb as e,db as p,hb as q,kb as P,lb as f,ub as o,wb as A,xa as r}from"./chunk-GQXGSY3T.js";import{a as N,b as D}from"./chunk-YEWEO3AL.js";function Z(i,d){if(i&1&&(n(0,"div",8),o(1),e()),i&2){let a=f();r(),A(" ",a.errorMessage," ")}}function ee(i,d){i&1&&(n(0,"div",9)(1,"p",10),o(2,"Guardando movimiento de inventario..."),e()())}function te(i,d){i&1&&(n(0,"div",32),o(1," ID de ingrediente es requerido. "),e())}function ie(i,d){i&1&&(n(0,"div",32),o(1," ID de usuario es requerido. "),e())}function ne(i,d){i&1&&(n(0,"div",32),o(1," Cantidad es requerida y debe ser mayor o igual a 0. "),e())}function oe(i,d){if(i&1&&(n(0,"option",33),o(1),e()),i&2){let a=d.$implicit;m("value",a),r(),A(" ",a," ")}}function re(i,d){i&1&&(n(0,"div",32),o(1," Tipo de movimiento es requerido. "),e())}function ae(i,d){i&1&&(n(0,"div",32),o(1," Fecha es requerida. "),e())}function le(i,d){i&1&&(n(0,"div",32),o(1," Costo total es requerido y debe ser mayor o igual a 0. "),e())}function de(i,d){if(i&1){let a=q();n(0,"form",11),P("ngSubmit",function(){E(a);let s=f();return w(s.onSave())}),n(1,"div")(2,"label",12),o(3,"ID Ingrediente"),e(),p(4,"input",13),c(5,te,2,0,"div",14),e(),n(6,"div")(7,"label",15),o(8,"ID Usuario"),e(),p(9,"input",16),c(10,ie,2,0,"div",14),e(),n(11,"div")(12,"label",17),o(13,"Cantidad"),e(),p(14,"input",18),c(15,ne,2,0,"div",14),e(),n(16,"div")(17,"label",19),o(18,"Tipo de Movimiento"),e(),n(19,"select",20)(20,"option",21),o(21,"Seleccione un tipo"),e(),c(22,oe,2,2,"option",22),e(),c(23,re,2,0,"div",14),e(),n(24,"div")(25,"label",23),o(26,"Fecha"),e(),p(27,"input",24),c(28,ae,2,0,"div",14),e(),n(29,"div")(30,"label",25),o(31,"Motivo"),e(),p(32,"textarea",26),e(),n(33,"div")(34,"label",27),o(35,"Costo Total"),e(),p(36,"input",28),c(37,le,2,0,"div",14),e(),n(38,"div",29)(39,"button",30),o(40," \u2705 Crear Movimiento "),e(),n(41,"button",31),P("click",function(){E(a);let s=f();return w(s.onCancel())}),o(42," \u274C Cancelar "),e()()()}if(i&2){let a,l,s,_,b,x,y,h,C,F,S,I,t=f();m("formGroup",t.createForm),r(4),g("border-red-500",((a=t.createForm.get("ingrediente_id"))==null?null:a.invalid)&&((a=t.createForm.get("ingrediente_id"))==null?null:a.touched)),r(),m("ngIf",((l=t.createForm.get("ingrediente_id"))==null?null:l.invalid)&&((l=t.createForm.get("ingrediente_id"))==null?null:l.touched)),r(4),g("border-red-500",((s=t.createForm.get("usuario_id"))==null?null:s.invalid)&&((s=t.createForm.get("usuario_id"))==null?null:s.touched)),r(),m("ngIf",((_=t.createForm.get("usuario_id"))==null?null:_.invalid)&&((_=t.createForm.get("usuario_id"))==null?null:_.touched)),r(4),g("border-red-500",((b=t.createForm.get("cantidad"))==null?null:b.invalid)&&((b=t.createForm.get("cantidad"))==null?null:b.touched)),r(),m("ngIf",((x=t.createForm.get("cantidad"))==null?null:x.invalid)&&((x=t.createForm.get("cantidad"))==null?null:x.touched)),r(4),g("border-red-500",((y=t.createForm.get("tipo_movimiento"))==null?null:y.invalid)&&((y=t.createForm.get("tipo_movimiento"))==null?null:y.touched)),r(3),m("ngForOf",t.tipoMovimientoOptions),r(),m("ngIf",((h=t.createForm.get("tipo_movimiento"))==null?null:h.invalid)&&((h=t.createForm.get("tipo_movimiento"))==null?null:h.touched)),r(4),g("border-red-500",((C=t.createForm.get("fecha"))==null?null:C.invalid)&&((C=t.createForm.get("fecha"))==null?null:C.touched)),r(),m("ngIf",((F=t.createForm.get("fecha"))==null?null:F.invalid)&&((F=t.createForm.get("fecha"))==null?null:F.touched)),r(8),g("border-red-500",((S=t.createForm.get("costo_total"))==null?null:S.invalid)&&((S=t.createForm.get("costo_total"))==null?null:S.touched)),r(),m("ngIf",((I=t.createForm.get("costo_total"))==null?null:I.invalid)&&((I=t.createForm.get("costo_total"))==null?null:I.touched)),r(2),m("disabled",t.createForm.invalid)}}var M=class i{_router=v(R);_fb=v(W);_inventarioService=v(Y);_cdr=v(k);createForm;isSaving=!1;errorMessage="";tipoMovimientoOptions=["Entrada","Salida","Ajuste"];ngOnInit(){this.createForm=this._fb.group({ingrediente_id:[null,u.required],usuario_id:[null,u.required],cantidad:[null,[u.required,u.min(0)]],tipo_movimiento:["",u.required],fecha:["",u.required],motivo:[""],costo_total:[null,[u.required,u.min(0)]]})}onSave(){if(this.createForm.valid){this.isSaving=!0,this.errorMessage="";let d=new Date().toISOString().split("T")[0],a=D(N({},this.createForm.value),{fecha:this.createForm.value.fecha||d});this._inventarioService.create(a).subscribe({next:()=>{this.isSaving=!1,this._cdr.markForCheck(),this._router.navigate(["/admin/inventario"])},error:l=>{this.isSaving=!1,this._cdr.markForCheck(),l.status===400?this.errorMessage="Datos inv\xE1lidos. Verifique que todos los campos est\xE9n completos correctamente.":l.status===500?this.errorMessage="Error interno del servidor. Intente nuevamente m\xE1s tarde.":l.status===0||!l.status?this.errorMessage="No se pudo conectar al servidor. Verifique su conexi\xF3n a internet.":this.errorMessage=`Error al crear el movimiento de inventario: ${l.message||"Error desconocido"}`}})}else console.log("Form is invalid, errors:",this.createForm.errors),this.errorMessage="Por favor, complete todos los campos requeridos correctamente",this.isSaving=!1}onCancel(){this._router.navigate(["/admin/inventario"])}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=T({type:i,selectors:[["admin-inventario-create-page"]],decls:10,vars:3,consts:[[1,"bg-gray-900","text-gray-100","min-h-screen","p-6"],[1,"max-w-4xl","mx-auto"],[1,"bg-gray-800","rounded-xl","shadow-lg","p-6"],[1,"border-b","border-gray-700","pb-4","mb-6"],[1,"text-2xl","font-bold","text-orange-500","mb-0"],["class","bg-red-600 text-white p-4 rounded-lg mb-4",4,"ngIf"],["class","text-center mt-3",4,"ngIf"],["class","space-y-6",3,"formGroup","ngSubmit",4,"ngIf"],[1,"bg-red-600","text-white","p-4","rounded-lg","mb-4"],[1,"text-center","mt-3"],[1,"text-gray-300"],[1,"space-y-6",3,"ngSubmit","formGroup"],["for","ingrediente_id",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","number","id","ingrediente_id","formControlName","ingrediente_id",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["class","text-red-400 text-sm mt-1",4,"ngIf"],["for","usuario_id",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","number","id","usuario_id","formControlName","usuario_id",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","cantidad",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","number","id","cantidad","formControlName","cantidad",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","tipo_movimiento",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["id","tipo_movimiento","formControlName","tipo_movimiento",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","fecha",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","date","id","fecha","formControlName","fecha",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","motivo",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["id","motivo","formControlName","motivo","rows","3",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],["for","costo_total",1,"block","text-sm","font-bold","text-orange-400","mb-2"],["type","number","step","0.01","id","costo_total","formControlName","costo_total",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-md","text-gray-100","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-orange-500"],[1,"flex","justify-end","space-x-4","mt-6"],["type","submit",1,"bg-orange-500","hover:bg-orange-600","text-white","px-6","py-2","rounded-md","shadow","transition","disabled:opacity-50",3,"disabled"],["type","button",1,"bg-gray-600","hover:bg-gray-700","text-white","px-6","py-2","rounded-md","shadow","transition",3,"click"],[1,"text-red-400","text-sm","mt-1"],[3,"value"]],template:function(a,l){a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),o(5,"\u{1F4E6} Crear Movimiento de Inventario"),e()(),n(6,"div"),c(7,Z,2,1,"div",5)(8,ee,3,0,"div",6)(9,de,43,21,"form",7),e()()()()),a&2&&(r(7),m("ngIf",l.errorMessage),r(),m("ngIf",l.isSaving),r(),m("ngIf",!l.isSaving))},dependencies:[G,V,O,X,U,L,Q,j,z,K,B,$,H,J],encapsulation:2,changeDetection:0})},Ce=M;export{M as AdminInventarioCreatePageComponent,Ce as default};
